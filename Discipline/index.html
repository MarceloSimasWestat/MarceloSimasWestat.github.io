<!DOCTYPE html>
<!--
    Hyperspace by Pixelarity
    pixelarity.com @pixelarity
    License: pixelarity.com/license
-->
<html lang="en-us">
<head>
    <title>Rethink Discipline, Rethink Suspension</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="assets/css/main.css" />
	    <!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
    <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->

    <!--<link rel="stylesheet" href="widgets.css" />-->
    <!-- <link rel="stylesheet" href="assets/css/chart-styles.css" /> -->

    <!-- browser tab icon (aka favicon) -->
    <link rel="icon" href="images/doelogo_rev.png" />

    <!-- Scripts -->
    <!--<script src="widgets.js"></script>-->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/skel.min.js"></script>
    <script src="assets/js/util.js"></script>
    <!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
    <script src="assets/js/main.js"></script>

    <!-- Substitutes high-res images for Retina displays (html file only) -->
    <script type="text/javascript" src="assets/js/retina.js"></script>

    <script src="assets/js/d3.v3.min.js"></script>
    <script src="assets/js/d3-tip.js"></script>
    <script src="assets/js/chart-functions.js"></script>
    <script src="assets/js/graph-scroll.js"></script>
	<script src="assets/js/queue.v1.min.js"></script>
    <script src="assets/js/topojson.v1.min.js"></script>

</head>
<body>

    <div id="loader-wrapper">
        <div id="loader"></div>
        <div class="loader-section"></div>
    </div>

    <!-- Sidebar -->
    <section id="sidebar">
        <div class="inner">

            <div class="nav-image">
                <img src="images/edsealbw.svg" alt="U.S. Department of Education" />
            </div>

            <div class="nav-wrapper">
                <nav>
                    <ul>
                        <li><a href="#intro">Introduction</a></li>
                        <li><a href="#one">Suspensions Mapped</a></li>
                        <li><a href="#two">Uneven Impact</a></li>
                        <li><a href="#three">The Preschool Crisis</a></li>
                        <li><a href="#four">Wrap Up</a></li>
                    </ul>
                </nav>
                <ul class="icons socialmedia" style="margin-bottom: 0;">
                    <li><a href="#" target="_blank" title="Tweet" class="fa-twitter"><span class="label">Twitter</span></a></li>
                    <li><a href="#" target="_blank" title="Share on Facebook" class="fa-facebook"><span class="label">Facebook</span></a></li>
                    <li><a href="#" target="_blank" title="Share on LinkedIn" class="fa-linkedin"><span class="label">LinkedIn</span></a></li>
                    <li><a href="#" target="_blank" title="Email" class="fa-envelope"><span class="label">Email</span></a></li>
                </ul>
            </div>

            <!-- Given Flex, this allows the social media icons to be paired with the navigation links without hugging the bottom -->
            <div>
                &nbsp;
            </div>
        </div>
    </section>

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Intro 1 -->
        <section id="intro" class="wrapper style1 fullscreen fade-up">
            <div class="inner">
                <h1 style="max-width: 650px;">RETHINK DISCIPLINE<br></h1>
                <p style="font-size:15pt">Who is losing critical learning time because of out-of-school suspension?</p>
                <ul class="actions">
                    <li><span class="buttonInactive">— U.S. Department of Education</span></li>
                </ul>
            </div>
        </section>

        <!-- InformED Shouout -->

        <section class="wrapper style5">
            <div class="inner align-center" style="padding-top: 40px; padding-bottom: 20px;">
                <div>
                    <i class="fa fa-bolt fa-lg" style="margin-bottom: 1em; color: rgba(255,255,255,1);"></i>
                </div>
                <p>Powered by InformED and the <a href="http://www2.ed.gov/about/offices/list/ocr/docs/crdc-2013-14.html">2013-14 Civil Rights Data Collection.</a></p>
            </div>
        </section>

        <!-- Intro 2 -->
        <section class="wrapper style3">
            <div class="inner">

                <div class="align-right">
                    <div style="margin-bottom: 2.5em;">
                        <input type="checkbox" id="highContrast" name="highContrast">
                        <label for="highContrast">Enable High Contrast (508)</label>
                    </div>
                </div>

                <h2 class="line">Suspensions shut out students</h2>
                <p class="afterHeader">
					The use of suspensions to discipline students begins as early as pre-kindergarten and continues until students graduate from high school.  School discipline is a complex and difficult issue. Schools and districts want to make sure campuses are safe and they strive to meet the needs of each student. But research has found that the vast majority of suspensions are <a href="https://civilrightsproject.ucla.edu/resources/projects/center-for-civil-rights-remedies/school-to-prison-folder/summary-reports/ccrr-school-to-prison-pipeline-2015/UCLA15_Report_9.pdf">not for acts of violence</a> nor are they <a href="http://knowledgecenter.csg.org/kc/content/breaking-schools-rules-statewide-study">required by statutes</a>.
                </p>
                <p>
                    But the impact of suspensions on students can be devastating. We know that students who are suspended are <a href="http://eric.ed.gov/?id=EJ767389">more likely to be retained in grade or to drop out</a>, and we know exclusionary discipline <a href="http://www.tandfonline.com/doi/abs/10.1080/10665684.2014.958965?journalCode=ueee20">feeds the school-to-prison pipeline</a>.
                </p>
                <p style="margin-bottom:3.5em;">
                    The Department of Education recently released data from the <a href="http://www2.ed.gov/about/offices/list/ocr/docs/crdc-2013-14.html">Civil Rights Data Collection</a> (CRDC) survey which helps shed light on who is suspended and where. The survey showed that students of color were also disproportionately affected by expulsions and referrals to law enforcement, though only out-of-school suspensions are examined here.
                </p>
                <div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="left icon fa-bar-chart-o"></span></div>
                        </div>
                        <div class="right">
                            Note: Data included in this story may differ slightly from other published reports due to certain data decisions.
                            <a href="#datanotes">More information</a>.
                        </div>
                    </div>
                </div>
                <p></p>
                <div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="left icon fa-mouse-pointer"></span></div>
                        </div>
                        <div class="right">
                            Our charts are interactive! Hover over or click on chart elements to learn more about specific data points
                            and, where they appear, use buttons to filter charts by select groups.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="intro_chart" class="wrapper image1">
			<div id = "intro_sections" class="inner align-center">
				<div></div>
				<div id = "counter_pre"></div>
				<div id = "counter" style="max-width: 736px;"></div>
			</div>
        </section>

        <!-- One -->
        <section id="one" class="wrapper style1">
            <div class="inner">
                <h2 class="line">Students across the country are removed from school for disciplinary reasons</h2>
                <p>
					We are seeing progress (the total number of students decreased by about 20% since the last CRDC data collection in 2011-12) as more and more schools <a href="http://www.ncbi.nlm.nih.gov/pubmed/19011963">find alternative ways of addressing non-violent discipline issues</a>. However this progress is not occurring in all areas, or for all groups of students. The map below shows which districts have the highest rates of out-of-school suspension. Hover over a district to see more information and zoom in for a closer look. You can also click on a specific range on the map legend to see which districts fall into a category.
                </p>
                <div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="legendPointer icon fa-mouse-pointer"></span></div>
                        </div>
                        <div class="legendExplain">
                            Our map is interactive! Hover over a school district to learn more, use legend to filter map by select groups.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Suspension Map -->
        <section class="wrapper chart">
            <div class="inner">
				<div>
					<div class="align-center">
						<div id="mapWrapper">
                            <div id="selectDistrictType">
                                <div id="selectElementary" class="selected ">Elementary and Unified</div>
                                <div id="selectSecondary" class="selected ">Independent Elementary, Secondary, and Unified
                                </div>
                            </div>
							<div id="legend">
								<h3><b>% of all students (preschool–12) who received one or more out-of-school
									suspension</b></h3>
                                <div class="legendButtonWrapper">
                                    <div data-value="#cbc9e2" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">0</div>
                                    </div><div data-value="#9e9ac8" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">3</div>
                                </div><div data-value="#756bb1" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">6</div>
                                </div><div data-value="#54278f" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">12</div>
                                        </div>
                                </div>
                                <div class="innerLegend">
                                    <div data-value="#a1d99b" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">0</div>
                                    </div><div data-value="gray" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">Missing*</div>
                                    </div>
                                </div>
							</div>
							<div id="map"></div>
						</div>
					</div>
				</div>
                <div>
                    <br/>
                    <p>* <a href="#datanotes">See data notes</a>.</p>
                </div>
            </div>
        </section>

        <!-- Two -->
        <section id="two" class="wrapper style3">
            <div class="inner">
                <h2 class="line">Who is suspended?</h2>
                <p>
					This tool provides data to shed light on the scope of the problem as well as on which students are most affected. School communities can use it as a resource as they think through the educational impact of suspensions and expulsions and whether systems of support can be set up for students and educators that will reduce the need for such measures.
                </p>
				<p>
					Educators will need to ask themselves difficult questions, such as: Could socioemotional supports like counseling or mentoring relationships make a difference?  Could instruction be strengthened to achieve better engagement or more appropriate differentiation?  Could training on issues of implicit bias or culturally relevant pedagogy change the outcome of a particular interaction?  Could parents or family members be <a href="http://www2.ed.gov/about/inits/ed/implementation-support-unit/tech-assist/framework-communications-engagement.pdf">engaged more effectively as partners</a>?  Could more learning time yield a better outcome than exclusion from the learning environment?
				</p>
            </div>
        </section>

        <section id="two_chart" class="wrapper chart">
            <div id="two_sections" class="inner">
                <div class="align-center">
                    <img class="barChart-icon" src="images/barIcon_chartArea.svg" alt="Bar Chart Icon" />
                </div>
                <div style="margin-bottom: 1.5em" class="chart"></div>
                <div></div>
                <div id="ch2_1"></div>
                <p style="margin-top: 1.5em;">
					Overall, about 5% of students received at least one out-of-school suspension in 2013-14. At more than twice that national average, the rate of suspensions was highest for black students at 13%. The next highest rate of suspension was 8% for American Indian students. Asian students were the least likely to be suspended with less than 2% of students receiving an out-of-school suspension.
                </p>
                <p style="margin-bottom: 3.5em;">
                    See suspension rates for other student groups in the next chart.
                </p>
                <p class="align-center" style="margin-top:3.5em;">View Chart By:</p>
                <div id="ch2_2"></div>
                <p style="margin-top:1.5em; margin-bottom: 3.5em;">
                    Though males are overall more likely to be suspended than females, how much more likely varies by race and ethnicity. The purple dot shows the percent of females who were suspended, the green dot the percentage of males suspended, while the line between shows the difference.
                </p>
                <div id="ch2_3"></div>
                <p style="margin-top: 1.5em;">
					Seventeen percent of black males received at least one out-of-school suspension. This compared to the 9% of black females who were suspended means that black males were almost eight percentage points more likely to be suspended than black females. Hispanic males were nearly four percentage points more likely than Hispanic females to be suspended, and white males were three percentage points more likely than white females.
                </p>
                <p>
                    When broken out further, by disability status, the data are even more disparaging. Though black males make up only 12% of those identified with disabilities, they make up 26% of students with disabilities who were suspended.
                </p>
                <div></div>
            </div>
        </section>

        <!-- Three -->
        <section id="three" class="wrapper style1">
            <div class="inner">

                <h2 class="line">Suspending our youngest students</h2>
                <p>
                    The goal should be to create school climates that motivate students to want to do their best, to support their classmates and to give back to their community, and to communicate in ways big and small to our students and educators that their potential is unlimited.  In general, punitive approaches not only do not control behavior, they <a href="http://www.indiana.edu/~equity/docs/Skiba_Reforming School Discipline.pdf">do not lead to better learning</a>.
                </p>
				<p>
					This is especially concerning since over 6,000 preschool students who were suspended in 2013-14. Are we setting these students up to succeed? Even at this early age, black students are disproportionately affected by out-of-school suspension.
				</p>
            </div>
        </section>

        <section id="three_chart" class="wrapper chart">
            <div id="three_sections" class="inner">
                <div class="align-center">
                    <img class="barChart-icon" src="images/barIcon_chartArea.svg" alt="Bar Chart Icon" />
                </div>
                <div style="margin-bottom: 1.5em" class="chart"></div>
                <div></div>
				<p class = "align-center">View Chart By:</p>
                <div id="ch3_1">
                </div>
                <p style="margin-top: 1.5em;">
					Nearly half of all suspended preschoolers were black and 1 in 5 were Hispanic. Additionally, though white students make up 42% of the preschool population, they only make up 28% of those suspended.  The data show that suspended preschoolers were overwhelmingly male and that students with disabilities and English learners were underrepresented in the suspended population.
                </p>
                <p style="margin-bottom: 3.5em;">
                    Digging deeper into this data shows that there are differences by gender within each race and ethnicity as well. The graph below shows whether each group is overrepresented or underrepresented when their proportion of those suspended is compared to their proportion of those enrolled.
                </p>
                <div id="ch3_2">
                </div>
				<p style="margin-top:1.5em;">
					<!--Note: For Pacific Islander, the difference was less than -0.1 for females and zero for males.-->Black females make up 9% of the preschool population but 12% of suspended students indicating that they are overrepresented in the suspension population by 3 percentage points. Black males had the highest rate of overrepresentation, they make up 25 percentage points more of the suspended population than they do of the enrollment population.
				</p>
				<p>
                    This disproportionate impact is why this Administration—through the President’s <a href="https://www.whitehouse.gov/my-brothers-keeper">My Brother’s Keeper</a> initiative as well as the Department’s <a href="http://www2.ed.gov/policy/gen/guid/school-discipline/index.html">#RethinkDiscipline</a> campaign—has made reforming school discipline one of its top priorities.
                </p>
                <div></div>
            </div>
        </section>

        <section id="four" class="wrapper style3">
            <div class="inner">
                <h2 class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit</h2>
                <p>
					Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam. Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus. Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum.
                </p>
                <p style="margin-bottom: 3.5em;">
					Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae:
				</p>
                <ul class="callout">
                    <li>
                        <h3 class="icon style1 fa-book">Integer non leo purus. Mauris convallis volutpat nisi, vel porta felis fringilla quis.</h3>

                        <p>Curabitur vel tellus a elit fermentum lacinia. Proin a neque eget felis ornare finibus. Nunc sed ultrices libero. Integer sed dictum est. Nam felis metus, commodo et cursus at, volutpat ut ex. Aenean bibendum eleifend diam imperdiet condimentum. Sed quis leo ut metus scelerisque consequat. Nullam congue nulla sed lectus congue, id ultrices nisi luctus. Nullam sed dapibus massa.</p>

                    </li>
                    <li>
                        <h3 class="icon style2 fa-graduation-cap">Maecenas facilisis tincidunt fermentum.</h3>
                        <p>Nunc vestibulum elementum purus cursus lobortis. Curabitur consequat, felis hendrerit dapibus rhoncus, arcu enim blandit dui, viverra porta tellus lectus quis neque. Fusce vulputate nec est vel viverra. Suspendisse nec mauris pellentesque, ultricies eros sed, auctor ligula. Vivamus tincidunt neque vel euismod euismod. Aenean iaculis urna ac ipsum accumsan posuere. Duis sagittis in justo sed viverra. Donec vitae libero aliquet orci porta dapibus condimentum eu risus. </p>
                    </li>
                    <li>
                        <h3 class="icon style3 fa-gavel">Pellentesque luctus facilisis lacus eu commodo.</h3>

                        <p>Nullam et lectus eu odio pellentesque sagittis in non eros. Integer vel nibh sed ex tristique feugiat non ac nibh. Mauris aliquam massa non suscipit ultricies. Mauris sed tellus facilisis, venenatis lorem posuere, aliquam diam. Maecenas dapibus scelerisque nunc ut feugiat. Ut vel augue sodales, lobortis erat vel, lacinia lectus. Aliquam massa justo, luctus ut facilisis ac, finibus a mauris. Mauris nec enim orci.</p>

                    </li>
                </ul>

            </div>
        </section>

        <section class="wrapper style1">
            <div class="inner">

                <div class="socialmedia">
                    <ul class="align-right icons">
                        <li><a href="#" target="_blank" title="Tweet" class="fa-twitter"><span class="label">Twitter</span></a></li>
                        <li><a href="#" target="_blank" title="Share on Facebook" class="fa-facebook"><span class="label">Facebook</span></a></li>
                        <li><a href="#" target="_blank" title="Share on LinkedIn" class="fa-linkedin"><span class="label">LinkedIn</span></a></li>
                        <li><a href="#" target="_blank" title="Email" class="fa-envelope"><span class="label">Email</span></a></li>
                    </ul>

                </div>

                <h2 class="line">Lorem ipsum dolor sit amet</h2>
                <p>
                    Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam.
                </p>

                <p>
                    Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus.
                </p>

                <p style="margin-bottom: 3.5em;">
                    Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum:
                </p>

                <ul class="callout">
                    <li>
                        <h3 class="icon style1 fa-bus"><a href="#">Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae.</a></h3>
                        <p>Cras malesuada, felis a congue rhoncus, felis ipsum venenatis justo, non viverra est sapien eu nisl. Suspendisse scelerisque non nibh et euismod. In condimentum diam vitae tellus vestibulum, ut rhoncus lectus finibus. </p>
                    </li>
                    <li>
                        <h3 class="icon style2 fa-trophy"><a href="#">Vivamus pulvinar pharetra sem vitae dapibus.</a></h3>
                        <p>Mauris convallis volutpat nisi, vel porta felis fringilla quis. Curabitur vel tellus a elit fermentum lacinia. Proin a neque eget felis ornare finibus. Nunc sed ultrices libero. Integer sed dictum est. Nam felis metus, commodo et cursus at, volutpat ut ex. Aenean bibendum eleifend diam imperdiet condimentum. </p>
                    </li>
                    <li>
                        <h3 class="icon style3 fa-table"><a href="#">Maecenas facilisis tincidunt fermentum. Nunc vestibulum elementum purus cursus lobortis.</a></h3>
                        <p>Curabitur consequat, felis hendrerit dapibus rhoncus, arcu enim blandit dui, viverra porta tellus lectus quis neque. Fusce vulputate nec est vel viverra. Suspendisse nec mauris pellentesque, ultricies eros sed, auctor ligula. Vivamus tincidunt neque vel euismod euismod. Aenean iaculis urna ac ipsum accumsan posuere. Duis sagittis in justo sed viverra. </p>
                    </li>
                </ul>

            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer id="footer" class="wrapper style1-alt">
        <div class="inner align-center">
			<h2 id="datanotes" class="line">Data Notes</h2>
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 class="line">Data Exclusion Rules</h3>
                <p>Data included in this story may differ slightly from other published reports due to certain data decisions. For the purposes of these analyses, schools with incomplete or inconsistent data values were excluded. Less than 5 percent of schools were excluded for the following reasons:</p>
                <ol>
                    <li>
                        The school reported incomplete data for enrollment and/or the count of students suspended for at least one race/ethnicity subgroup.
                    </li>
                    <li>
						The count of students suspended was larger than the school enrollment for at least one race/ethnicity subgroup. Schools with partial or missing data for English learners were included in all analyses except those that focused on these subgroups.
                    </li>
                </ol>
            </div>
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 class="line">Preschool Definition</h3>
                <p>The definition of preschool used in the Civil Rights Data Collection (CRDC) includes preschool programs and services for children ages 3 through 5.</p>
            </div>			
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 style="font-size: 15px;" class="line">Map Notes</h3>
                <p>Data might be missing from the map if:</p>
                <ol>
                    <li>It did not report suspension data or the data were inconsistent.</li>
                    <li>It reported suspension data that did not match with the NCES district boundary file.</li>
                    <li>Twenty-five percent of its enrollment was in schools with incomplete or inconsistent data (see Data Exclusion Rules).</li>
                </ol>
				<p>District data displayed on the map may not be based on all schools in the district. All districts with data have complete and consistent data for at least 75 percent of their enrollment.</p>
            </div>
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 style="font-size: 15px;" class="line">Other Technical Notes</h3>
                <p>This report uses three different types of percentages: a suspension rate, an enrollment composition percent, and a suspension composition percent.</p>
                <ul style="font-size: 12px;">
                    <li>The suspension rate is the number of students suspended divided by the number of students enrolled. A suspension rate is calculated overall and for each subgroup group.</li>
                    <li>The enrollment composition percent is the number of subgroup students enrolled divided by the total number of students enrolled.</li>
                    <li>The suspension composition percent is the number of subgroup students suspended divided by the total number of students suspended.</li>
                </ul>
				<p>When calculating the suspension rate for students with disabilities in each racial/ethnic group, suppressed enrollment counts were imputed to zero. Enrollment by race/ethnicity for students with disabilities was suppressed for privacy protection when the count was fewer than three (including zero).</p>
            </div>
		</div>

    </footer>

    <!-- Charts -->

    <script>

        // charts

        d3.tsv("assets/data/data.tsv", function (error, data) {
            if (error) { console.log(error); }
            else {
                data.forEach(function (d) {
					d.chart = d.chart;
					d.subchart = +d.subchart;
					d.level = d.level;
                    d.group = d.group;
					d.overall_n = +d.overall_n;
					d.overall_p = +d.overall_p;
                    d.male_n = +d.male_n;
                    d.male_p = +d.male_p;
                    d.female_n = +d.female_n;
                    d.female_p = +d.female_p;
					d.enrolled_p = +d.enrolled_p;
					d.suspended_p = +d.suspended_p;
					d.diff_ppt = +d.diff_ppt;
					d.enrolled_n = +d.enrolled_n;
					d.suspended_n = +d.suspended_n;
                });

				data1_2 = data.filter(function(d) { return d.chart == "1-2"; });
				data2_1 = data.filter(function(d) { return d.chart == "2-1"; });
				data2_2 = data.filter(function(d) { return d.chart == "2-2"; });
                data2_3 = data.filter(function(d) { return d.chart == "2-3"; });
				data3_1 = data.filter(function(d) { return d.chart == "3-1"; });
				data3_2 = data.filter(function(d) { return d.chart == "3-2"; });

				var counterChart = counter().data(data1_2).containerID("intro_chart").subcontainerID("intro_sections").sectionID("counter").chartID("counter");
				var chart2_1 = barChart().marginLeft(150).data(data2_1).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_1").chartID("chart2_1")
					.title("Black students are the most likely to be removed from school for disciplinary reason.");
				var chart2_2 = columnThree().data(data2_2).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_2").chartID("chart2_2")
					.title1("Male students are more than twice as likely to be suspended as female students.")
					.title2("1 in 10 students with disabilities received at least one out-of-school suspension.")
					.title3("English language learners are suspended at a rate less than the national average.");
                var chart2_3 = dotTwo().marginLeft(150).data(data2_3).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_3").chartID("chart2_3")
					.title("Males are more likely to be suspended in every racial and ethnic group.");
				var chart3_1 = groupedBar().data(data3_1).marginLeft(150).animateTime(750).containerID("three_chart").subcontainerID("three_sections").sectionID("ch3_1").chartID("chart3_1")
					.title1("Though black students make up only 19% of the preschool population, they make up 46% of suspended preschoolers.")
					.title2("78% of all suspended preschoolers were male.")
					.title3("Though 20% of all preschools were identified as having a disability, they make up only 15% of those suspended.")
					.title4("Preschoolers who are English learners make up 7% of those suspended though they make up 13% of the population.");
                var chart3_2 = groupedBarDiv().marginLeft(150).data(data3_2).containerID("three_chart").subcontainerID("three_sections").sectionID("ch3_2").chartID("chart3_2")
					.title("Black females are the only group of females who are overrepresented in preschool suspensions.");

				d3.select("#counter").call(counterChart);
				d3.select("#ch2_1").call(chart2_1);
				d3.select("#ch2_2").call(chart2_2);
                d3.select("#ch2_3").call(chart2_3);
				d3.select("#ch3_1").call(chart3_1);
				d3.select("#ch3_2").call(chart3_2);

            };
        });

    </script>

	<!-- Map -->

	<script>
        $("#legend").css("display", "none");
        //  D3 MAP
        var width = 960;
        var height = 600;
        var center = [width / 2, height / 2];
        var defaultFill = "#f0f0f0";

        var projection = d3.geo.albersUsa()
                .translate([width / 2, height / 2])
                .scale(1000);
        var zoom = d3.behavior.zoom()
                .scaleExtent([1, 32])
                .on("zoom", move);

        var path = d3.geo.path()
                .projection(projection);

        var svg = d3.select("#map").append("svg")
                .attr("preserveAspectRatio", "xMinYMin meet")
                .attr("viewBox", "0 0 " + width + " " + height)
                .classed("svg-content-responsive", true)
                .append("g");

        var g = svg.append("g");

        svg.append("svg:image")
                .attr("xlink:href", "images/progress-anim.gif")
                .attr("id", "progress-image")
                .attr("width", 43)
                .attr("height", 11)
                .attr("x", width / 2)
                .attr("y", height / 2)
                .style("opacity", 1);

        svg.call(zoom).call(zoom.event);

        var tooltip = d3.select("body").append("div")
                .attr("class", "districtTooltip")
                .style("opacity", 0);

        queue()
                .defer(d3.json, "assets/data/us.json")
                .defer(d3.json, "assets/data/elementary_unified.json")
                .defer(d3.json, "assets/data/secondary.json")
                .await(ready);

        svg.on("wheel.zoom", null);
        svg.on("mousewheel.zoom", null);

        function ready(error, us, primary, secondary) {
            if (error) {
                console.log(error);
            }
            g.attr("cursor","pointer");

            g.append("g")
                    .selectAll("path")
                    .data(topojson.feature(primary, primary.objects.medium_G5420_G5400).features)
                    .enter().append("path")
                    .attr("id", "elementaryDistrict")
                    .attr("class", "district")
                    .attr("d", path)
                    .attr("stroke", "#fff")
                    .attr("stroke-opacity", .15)
                    .attr("stroke-linejoin", "round")
                    .on("mouseover", function (d) {
                        var format = d3.format("0,000");
                        var decimal = d3.format(",.1f");
                        var state = d.properties.State;
                        var name = d.properties.Name;
                        var totalEnrollment = format(d.properties["Total Enrollment"]);
                        var totalStudentOOS = format(d.properties["Total Students OOS"]);
                        var percentOOS = decimal(d.properties['Percent OOS'].replace("%",""))+'%';
                        d3.select(this).attr("stroke", "#1A1C20")
                                .attr("stroke-opacity", 1);
                        d3.select(this).classed("selected", true);

                        tooltip.transition().duration(100)
                                .style("opacity", 1)
                                .style("top", (d3.event.pageY - 100) + "px");

                        var windowWidth = $(window).width();
                        if (windowWidth > 1024) {
                            if (d3.event.pageX > 1000) {
                                tooltip.style("left", (d3.event.pageX - 220) + "px");
                            } else {
                                tooltip.style("left", (d3.event.pageX + 40) + "px");
                            }
                        }
                        if (windowWidth < 1024) {
                            if (d3.event.pageX > 400) {
                                tooltip.style("left", (d3.event.pageX - 220) + "px");
                            } else {
                                tooltip.style("left", (d3.event.pageX + 40) + "px");
                            }
                        }
                        if (percentOOS != null && totalStudentOOS != null) {
                            tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                                    "<h4>" + name + "</h4><hr>" +
                                    "<div>" + percentOOS + "</div>" +
                                    "<div>( " + totalStudentOOS + " out of " + totalEnrollment + " students )</div>");
                        } else if (name === "School District Not Defined") {
                            tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                                    "<h3>No Operating District</h3>");

                        } else {
                            tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                                    "<h4>" + name + "</h4><hr>" +
                                    "<div> NO DATA </div>");
                        }
                    })
                    .on("mouseout", function () {
                        d3.select(this).attr("stroke", "#fff")
                                .attr("stroke-opacity", .15);
                        d3.select(this).classed("selected", false);
                        tooltip.transition().duration(300).style("opacity", 0);
                    });

            g.append("g")
                    .attr("class", "states")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.states).features)
                    .enter().append("path")
                    .attr("class", "state")
                    .attr("d", path);

            d3.select("#selectElementary").on("click", function () {
                d3.select("#selectSecondary").style("background", "white");
                d3.select(this).style("background", "yellow");
                d3.selectAll("#secondaryDistrict").remove();
            });

            d3.select("#selectSecondary").on("click", function () {
                d3.selectAll(".state").remove();
                d3.select("#selectElementary").style("background", "white");
                d3.select(this).style("background", "yellow");
                g.append("g")
                        .selectAll("path")
                        .data(topojson.feature(secondary, secondary.objects.medium_G5410).features)
                        .enter().append("path")
                        .attr("id", "secondaryDistrict")
                        .attr("class", "district")
                        .attr("d", path)
                        .attr("stroke", "#fff")
                        .attr("stroke-opacity", .15)
                        .attr("stroke-linejoin", "round")
                        .on("mouseover", function (d) {
                            var format = d3.format("0,000");
                            var decimal = d3.format(",.1f");
                            var state = d.properties.State;
                            var name = d.properties.Name;
                            var totalEnrollment = format(d.properties["Total Enrollment"]);
                            var totalStudentOOS = format(d.properties["Total Students OOS"]);
                            var percentOOS = decimal(d.properties['Percent OOS'].replace("%",""))+'%';
                            d3.select(this).attr("stroke", "#1A1C20")
                                    .attr("stroke-opacity", 1);
                            d3.select(this).classed("selected", true);

                            tooltip.transition().duration(100)
                                    .style("opacity", 1)
                                    .style("top", (d3.event.pageY - 100) + "px");

                            var windowWidth = $(window).width();
                            if (windowWidth > 1024) {
                                if (d3.event.pageX > 1000) {
                                    tooltip.style("left", (d3.event.pageX - 200) + "px");
                                } else {
                                    tooltip.style("left", (d3.event.pageX + 40) + "px");
                                }
                            }
                            if (windowWidth < 1024) {
                                if (d3.event.pageX > 400) {
                                    tooltip.style("left", (d3.event.pageX - 200) + "px");
                                } else {
                                    tooltip.style("left", (d3.event.pageX + 40) + "px");
                                }
                            }
                            if (percentOOS != null && totalStudentOOS != null) {
                                tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                                        "<h4>" + name + "</h4><hr>" +
                                        "<div>" + percentOOS + "</div>" +
                                        "<div>( " + totalStudentOOS + " out of " + totalEnrollment + " students )</div>");
                            } else if (name === "School District Not Defined") {
                                tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                                        "<h3>No Operating District</h3>");

                            } else {
                                tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                                        "<h4>" + name + "</h4><hr>" +
                                        "<div> NO DATA </div>");
                            }
                        })
                        .on("mouseout", function () {
                            d3.select(this).attr("stroke", "#fff")
                                    .attr("stroke-opacity", .15);
                            d3.select(this).classed("selected", false);
                            tooltip.transition().duration(300).style("opacity", 0);
                        });
                updateColors();
                g.append("g")
                        .attr("class", "states")
                        .selectAll("path")
                        .data(topojson.feature(us, us.objects.states).features)
                        .enter().append("path")
                        .attr("class", "state")
                        .attr("d", path);
            });

            // Zoom buttons
            svg.selectAll(".button")
                    .data(['zoom_in', 'zoom_out'])
                    .enter()
                    .append("g")
                    .attr("id", function (d) {
                        return d
                    })
                    .attr("class", "button")
                    .attr({x: 20, width: 20, height: 20})
                    .append("rect")
                    .attr("class", function (d) {
                        return d
                    })
                    .attr("y", function (d, i) {
                        return 20 + 25 * i
                    })
                    .attr({x: 20, width: 20, height: 20});

            // Plus button
            svg.select("#zoom_in")
                    .append("text").text("+")
                    .attr("class", function (d) {
                        return d
                    })
                    .style("fill", "white")
                    .style("font-size", "20px")
                    .attr("y", 35)
                    .attr({x: 24.5, width: 20, height: 20})
                    .on('click', zoomClick);

            // Minus button
            svg.select("#zoom_out")
                    .append("text").text("-")
                    .attr("class", function (d) {
                        return d
                    })
                    .style("fill", "white")
                    .style("font-size", "20px")
                    .attr("y", 60)
                    .attr({x: 26, width: 20, height: 20})
                    .on('click', zoomClick);

            updateColors();
            createLegend();
            svg.select("#progress-image").style("opacity", 0);
            $("#legend").css("display", "block");
        }

        // D3 MAP SCALE
        function createLegend() {
            var legendButton = $(".legendButton");
            legendButton.each(function () {
                var buttonValue = $(this).attr("data-value");
                var totalDistricts = document.getElementsByClassName("district").length;
                var valueSize = document.getElementsByClassName(buttonValue).length;
                var width = (valueSize / totalDistricts) * 100;
                $(this).css("background-color", buttonValue);
                $(this).css("width", (width) + '%');
            });

            legendButton.on("click", function () {
                if ($(this).hasClass("highlightButton")) {
                    legendButton.each(function () {
                        $(this).css("border-color", "white");
                        $(this).removeClass("highlightButton");
                    });
                    updateColors();
                } else {
                    legendButton.each(function () {
                        $(this).css("border-color", "white");
                        $(this).removeClass("highlightButton");
                    });
                    $(this).addClass("highlightButton");
                    $(this).css("border-color", "black");
                    var buttonValue = $(this).attr("data-value");
                    svg.selectAll(".district")
                            .attr("fill", function (d) {
                                if (buttonValue == colorByGroup(d.properties["Percent OOS"])) {
                                    return buttonValue;
                                } else {
                                    return "#f0f0f0";
                                }
                            });
                }
            });

        }

        function updateColors() {
            svg.selectAll(".district")
                    .attr("fill", function (d) {
                        d3.select(this).attr("class", "district " + colorByGroup(d.properties["Percent OOS"]));
                        return colorByGroup(d.properties["Percent OOS"]);
                    });
        }

        function colorByGroup(p) {

            var d = isNaN(parseFloat(p)) ? -1 : parseFloat(p);
            return d == 0 ? '#a1d99b' :
                    (d > 0 && d <= 3) ? '#cbc9e2' :
                            (d > 3 && d <= 6) ? '#9e9ac8' :
                                    (d > 6 && d <= 12) ? '#756bb1' :
                                            (d > 12) ? '#54278f' :
                                                    (d < 0) ? 'gray' :
                                                            defaultFill;
        }

        function interpolateZoom(translate, scale) {
            var self = this;
            return d3.transition().duration(350).tween("zoom", function () {
                var iTranslate = d3.interpolate(zoom.translate(), translate),
                        iScale = d3.interpolate(zoom.scale(), scale);
                return function (t) {
                    zoom
                            .scale(iScale(t))
                            .translate(iTranslate(t));
                    move();
                };
            });
        }

        function zoomClick() {
            var clicked = d3.event.target,
                    direction = 1,
                    factor = 0.2,
                    target_zoom = 1,
                    center = [width / 2, height / 2],
                    extent = zoom.scaleExtent(),
                    translate = zoom.translate(),
                    translate0 = [],
                    l = [],
                    view = {x: translate[0], y: translate[1], k: zoom.scale()};

            d3.event.preventDefault();
            direction = (d3.select(this).attr("class") === 'zoom_in') ? 1 : -1;
            target_zoom = zoom.scale() * (1 + factor * direction);

            if (target_zoom < extent[0] || target_zoom > extent[1]) {
                return false;
            }

            translate0 = [(center[0] - view.x) / view.k, (center[1] - view.y) / view.k];
            view.k = target_zoom;
            l = [translate0[0] * view.k + view.x, translate0[1] * view.k + view.y];

            view.x += center[0] - l[0];
            view.y += center[1] - l[1];

            interpolateZoom([view.x, view.y], view.k);
        }

        function move() {
            g.style("stroke-width", 1 / zoom.scale())
                    .attr("transform", "translate(" + zoom.translate() + ")scale(" + zoom.scale() + ")");
        }

        d3.select(self.frameElement).style("height", height + "px");

	</script>

</body>
</html>
