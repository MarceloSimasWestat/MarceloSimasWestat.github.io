<!DOCTYPE html>
<!--
    Hyperspace by Pixelarity
    pixelarity.com @pixelarity
    License: pixelarity.com/license
-->
<html lang="en-us">
<head>
    <title>Page Title</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="assets/css/main.css" />
	    <!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
    <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->

    <!--<link rel="stylesheet" href="widgets.css" />-->
    <!-- <link rel="stylesheet" href="assets/css/chart-styles.css" /> -->

    <!-- browser tab icon (aka favicon) -->
    <link rel="icon" href="images/doelogo_rev.png" />

    <!-- Scripts -->
    <!--<script src="widgets.js"></script>-->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/skel.min.js"></script>
    <script src="assets/js/util.js"></script>
    <!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
    <script src="assets/js/main.js"></script>

    <!-- Substitutes high-res images for Retina displays (html file only) -->
    <script type="text/javascript" src="assets/js/retina.js"></script>

    <script src="assets/js/d3.v3.min.js"></script>
    <script src="assets/js/d3-tip.js"></script>
    <script src="assets/js/chart-functions.js"></script>
    <script src="assets/js/graph-scroll.js"></script>	
	<script src="assets/js/queue.v1.min.js"></script>
    <script src="assets/js/topojson.v1.min.js"></script>

</head>
<body>

    <div id="loader-wrapper">
        <div id="loader"></div>
        <div class="loader-section"></div>
    </div>

    <!-- Sidebar -->
    <section id="sidebar">
        <div class="inner">

            <div class="nav-image">
                <img src="images/edsealbw.svg" alt="Department of Learning" />
            </div>

            <div class="nav-wrapper">
                <nav>
                    <ul>
                        <li><a href="#intro">Introduction</a></li>
                        <li><a href="#one">Suspensions Mapped</a></li>
                        <li><a href="#two">Who is Impacted</a></li>
                        <li><a href="#three">The Preschool Crisis</a></li>
                        <li><a href="#four">Wrap Up</a></li>
                    </ul>
                </nav>
                <ul class="icons socialmedia" style="margin-bottom: 0;">
                    <li><a href="#" target="_blank" title="Tweet" class="fa-twitter"><span class="label">Twitter</span></a></li>
                    <li><a href="#" target="_blank" title="Share on Facebook" class="fa-facebook"><span class="label">Facebook</span></a></li>
                    <li><a href="#" target="_blank" title="Share on LinkedIn" class="fa-linkedin"><span class="label">LinkedIn</span></a></li>
                    <li><a href="#" target="_blank" title="Email" class="fa-envelope"><span class="label">Email</span></a></li>
                </ul>
            </div>

            <!-- Given Flex, this allows the social media icons to be paired with the navigation links without hugging the bottom -->
            <div>
                &nbsp;
            </div>
        </div>
    </section>

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Intro 1 -->
        <section id="intro" class="wrapper style1 fullscreen fade-up">
            <div class="inner">
                <h1 style="max-width: 650px;">DISCIPLINE DATA STORY<br></h1>
                <p style="font-size:15pt">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                <ul class="actions">
                    <li><span class="buttonInactive">— U.S. Department of Education</span></li>
                </ul>
            </div>
        </section>

        <!-- InformED Shouout -->

        <section class="wrapper style5">
            <div class="inner align-center" style="padding-top: 40px; padding-bottom: 20px;">
                <div>
                    <i class="fa fa-bolt fa-lg" style="margin-bottom: 1em; color: rgba(255,255,255,1);"></i>
                </div>
                <p>Powered by InformED and the <a href="http://www2.ed.gov/about/offices/list/ocr/docs/crdc-2013-14.html">2013-14 Civil Rights Data Collection.</a></p>
            </div>
        </section>

        <!-- Intro 2 -->
        <section class="wrapper style3">
            <div class="inner">

                <div class="align-right">
                    <div style="margin-bottom: 2.5em;">
                        <input type="checkbox" id="highContrast" name="highContrast">
                        <label for="highContrast">Enable High Contrast (508)</label>
                    </div>
                </div>

                <h2 class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2>
                <p class="afterHeader">
                    Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam. Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus. Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum.
                </p>
                <p>
                    Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec a rhoncus risus. Nam tincidunt, nisi id blandit commodo, neque leo bibendum nunc, a finibus lorem nunc at enim. Maecenas iaculis tellus turpis, non condimentum neque pulvinar ac. Cras malesuada, felis a congue rhoncus, felis ipsum venenatis justo, non viverra est sapien eu nisl. Suspendisse scelerisque non nibh et euismod. In condimentum diam vitae tellus vestibulum, ut rhoncus lectus finibus. Vestibulum vulputate nisi ante, id tincidunt velit mattis a. Nunc sodales congue blandit. Pellentesque vitae scelerisque mi. Integer non dolor sollicitudin, venenatis dolor nec, imperdiet neque. Fusce eu orci dolor. Vivamus pulvinar pharetra sem vitae dapibus.
                </p>
                <p style="margin-bottom:3.5em;">
                    Integer non leo purus. Mauris convallis volutpat nisi, vel porta felis fringilla quis. Curabitur vel tellus a elit fermentum lacinia. Proin a neque eget felis ornare finibus. Nunc sed ultrices libero. Integer sed dictum est. Nam felis metus, commodo et cursus at, volutpat ut ex. Aenean bibendum eleifend diam imperdiet condimentum. Sed quis leo ut metus scelerisque consequat. Nullam congue nulla sed lectus congue, id ultrices nisi luctus. Nullam sed dapibus massa.
                </p>
                <div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="left icon fa-bar-chart-o"></span></div>
                        </div>
                        <div class="right">
                            Note: Data included in this story may differ slightly from other published reports due to certain data decisions.
                            <a href="#datanotes">More information</a>.
                        </div>
                    </div>
                </div>
                <p></p>
                <div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="left icon fa-mouse-pointer"></span></div>
                        </div>
                        <div class="right">
                            Our charts are interactive! Hover over or click on chart elements to learn more about specific data points
                            and, where they appear, use buttons to filter charts by select groups.
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="intro_chart" class="wrapper image1">
            <div id = "intro_sections" class="inner">
				<div></div>
                <div id="counter" class="6u$ 12u$(medium)">
					<h2 style="line-height: 2em;">
						OVER</br>
					</h2>
					<p style="margin-top:1.5em; line-height: 1.75em;">
						Preschool-12 students received at least one out-of-school suspension in 2013-14.
					</p>
				</div>
				<div></div>
			</div>
        </section>
		
        <!-- One -->
        <section id="one" class="wrapper style1">
            <div class="inner">
                <h2 class="line">Lorem ipsum dolor sit amet</h2>
                <p>
					Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam. Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus. Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum.
                </p>

            </div>
        </section>

        <section class="wrapper chart">
            <div class="inner">
				<div>
					<div class="align-center">
						<div id="mapWrapper">
							<div id="legend">
								<h3><b>% of all students (preschool–12) who received one or more out-of-school
									suspension</b></h3>
							</div>
							<div id="selectDistrictType">
								<div id="selectElementary" class="selected ">Elementary and Unified</div>
								<div id="selectSecondary" class="selected ">Independent Elementary, Secondary, and Unified
								</div>
							</div>
							<div id="map"></div>
						</div>
					</div>
				</div>
                <div>
                    <br/>
                    <p>* <a href="#datanotes">See data notes</a>.</p>
                </div>
            </div>		
        </section>

        <!-- Two -->
        <section id="two" class="wrapper style3">
            <div class="inner">
                <h2 class="line">Lorem ipsum dolor sit amet</h2>
                <p>
					Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam. Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus. Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum.
                </p>

            </div>
        </section>

        <section id="two_chart" class="wrapper chart">
            <div id="two_sections" class="inner">
                <div class="align-center">
                    <img class="barChart-icon" src="images/barIcon_chartArea.svg" alt="Bar Chart Icon" />
                </div>
                <div style="margin-bottom: 1.5em" class="chart"></div>
                <div></div>
                <div id="ch2_1">
                </div>
                <p style="margin-top: 1.5em;">
					Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec a rhoncus risus.
                </p>
                <p style="margin-bottom: 3.5em;">
                    Nam tincidunt, nisi id blandit commodo, neque leo bibendum nunc, a finibus lorem nunc at enim. Maecenas iaculis tellus turpis, non condimentum neque pulvinar ac.
                </p>
                <p class="align-center" style="margin-top:3.5em;">View Chart By:</p>
                <div id="ch2_2">
                </div>
                <p style="margin-top:1.5em; margin-bottom: 3.5em;">
                    Cras malesuada, felis a congue rhoncus, felis ipsum venenatis justo, non viverra est sapien eu nisl. Suspendisse scelerisque non nibh et euismod. In condimentum diam vitae tellus vestibulum, ut rhoncus lectus finibus. Vestibulum vulputate nisi ante, id tincidunt velit mattis a. Nunc sodales congue blandit. Pellentesque vitae scelerisque mi.
                </p>
                <div id="ch2_3">
                </div>
                <div></div>
            </div>
        </section>

        <!-- Three -->
        <section id="three" class="wrapper style1">
            <div class="inner">

                <h2 class="line">Lorem ipsum dolor sit amet</h2>
                <p>
                    Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. 
                </p>
            </div>
        </section>

        <section id="three_chart" class="wrapper chart">
            <div id="three_sections" class="inner">
                <div class="align-center">
                    <img class="barChart-icon" src="images/barIcon_chartArea.svg" alt="Bar Chart Icon" />
                </div>
                <div style="margin-bottom: 1.5em" class="chart"></div>
                <div></div>
				<p class = "align-center">View Chart By:</p>
                <div id="ch3_1">
                </div>
                <p style="margin-top: 1.5em;">
					Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec a rhoncus risus.
                </p>
                <p style="margin-bottom: 3.5em;">
                    Nam tincidunt, nisi id blandit commodo, neque leo bibendum nunc, a finibus lorem nunc at enim. Maecenas iaculis tellus turpis, non condimentum neque pulvinar ac.
                </p>
                <div id="ch3_2">
                </div>
				<p style="margin-top:1.5em;">
					Note: For Pacific Islander, the difference was less than -0.1 for females and zero for males.
				</p>
				<p style="margin-bottom: 3.5em;">
                    Cras malesuada, felis a congue rhoncus, felis ipsum venenatis justo, non viverra est sapien eu nisl. Suspendisse scelerisque non nibh et euismod. In condimentum diam vitae tellus vestibulum, ut rhoncus lectus finibus. Vestibulum vulputate nisi ante, id tincidunt velit mattis a. Nunc sodales congue blandit. Pellentesque vitae scelerisque mi.
                </p>
                <div></div>
            </div>
        </section>

        <section id="four" class="wrapper style3">
            <div class="inner">
                <h2 class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit</h2>
                <p>
					Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam. Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus. Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum.
                </p>
                <p style="margin-bottom: 3.5em;">
					Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae:
				</p>
                <ul class="callout">
                    <li>
                        <h3 class="icon style1 fa-book">Integer non leo purus. Mauris convallis volutpat nisi, vel porta felis fringilla quis.</h3>

                        <p>Curabitur vel tellus a elit fermentum lacinia. Proin a neque eget felis ornare finibus. Nunc sed ultrices libero. Integer sed dictum est. Nam felis metus, commodo et cursus at, volutpat ut ex. Aenean bibendum eleifend diam imperdiet condimentum. Sed quis leo ut metus scelerisque consequat. Nullam congue nulla sed lectus congue, id ultrices nisi luctus. Nullam sed dapibus massa.</p>

                    </li>
                    <li>
                        <h3 class="icon style2 fa-graduation-cap">Maecenas facilisis tincidunt fermentum.</h3>
                        <p>Nunc vestibulum elementum purus cursus lobortis. Curabitur consequat, felis hendrerit dapibus rhoncus, arcu enim blandit dui, viverra porta tellus lectus quis neque. Fusce vulputate nec est vel viverra. Suspendisse nec mauris pellentesque, ultricies eros sed, auctor ligula. Vivamus tincidunt neque vel euismod euismod. Aenean iaculis urna ac ipsum accumsan posuere. Duis sagittis in justo sed viverra. Donec vitae libero aliquet orci porta dapibus condimentum eu risus. </p>
                    </li>
                    <li>
                        <h3 class="icon style3 fa-gavel">Pellentesque luctus facilisis lacus eu commodo.</h3>

                        <p>Nullam et lectus eu odio pellentesque sagittis in non eros. Integer vel nibh sed ex tristique feugiat non ac nibh. Mauris aliquam massa non suscipit ultricies. Mauris sed tellus facilisis, venenatis lorem posuere, aliquam diam. Maecenas dapibus scelerisque nunc ut feugiat. Ut vel augue sodales, lobortis erat vel, lacinia lectus. Aliquam massa justo, luctus ut facilisis ac, finibus a mauris. Mauris nec enim orci.</p>

                    </li>
                </ul>

            </div>
        </section>

        <section class="wrapper style1">
            <div class="inner">

                <div class="socialmedia">
                    <ul class="align-right icons">
                        <li><a href="#" target="_blank" title="Tweet" class="fa-twitter"><span class="label">Twitter</span></a></li>
                        <li><a href="#" target="_blank" title="Share on Facebook" class="fa-facebook"><span class="label">Facebook</span></a></li>
                        <li><a href="#" target="_blank" title="Share on LinkedIn" class="fa-linkedin"><span class="label">LinkedIn</span></a></li>
                        <li><a href="#" target="_blank" title="Email" class="fa-envelope"><span class="label">Email</span></a></li>
                    </ul>

                </div>

                <h2 class="line">Lorem ipsum dolor sit amet</h2>
                <p>
                    Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam. 
                </p>

                <p>
                    Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus.
                </p>

                <p style="margin-bottom: 3.5em;">
                    Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum:
                </p>

                <ul class="callout">
                    <li>
                        <h3 class="icon style1 fa-bus"><a href="#">Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae.</a></h3>
                        <p>Cras malesuada, felis a congue rhoncus, felis ipsum venenatis justo, non viverra est sapien eu nisl. Suspendisse scelerisque non nibh et euismod. In condimentum diam vitae tellus vestibulum, ut rhoncus lectus finibus. </p>
                    </li>
                    <li>
                        <h3 class="icon style2 fa-trophy"><a href="#">Vivamus pulvinar pharetra sem vitae dapibus.</a></h3>
                        <p>Mauris convallis volutpat nisi, vel porta felis fringilla quis. Curabitur vel tellus a elit fermentum lacinia. Proin a neque eget felis ornare finibus. Nunc sed ultrices libero. Integer sed dictum est. Nam felis metus, commodo et cursus at, volutpat ut ex. Aenean bibendum eleifend diam imperdiet condimentum. </p>
                    </li>
                    <li>
                        <h3 class="icon style3 fa-table"><a href="#">Maecenas facilisis tincidunt fermentum. Nunc vestibulum elementum purus cursus lobortis.</a></h3>
                        <p>Curabitur consequat, felis hendrerit dapibus rhoncus, arcu enim blandit dui, viverra porta tellus lectus quis neque. Fusce vulputate nec est vel viverra. Suspendisse nec mauris pellentesque, ultricies eros sed, auctor ligula. Vivamus tincidunt neque vel euismod euismod. Aenean iaculis urna ac ipsum accumsan posuere. Duis sagittis in justo sed viverra. </p>
                    </li>
                </ul>

            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer id="footer" class="wrapper style1-alt">
        <div class="inner align-center">
			<h2 class="line">Data Notes</h2>
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 id="datanotes" class="line">Data Exclusion Rules</h3>
                <p>Data included in this story may differ slightly from other published reports due to certain data decisions. For the purposes of these analyses, schools with incomplete or inconsistent data values were excluded. Less than x% of schools were excluded for the following reasons:</p>
                <ol>
                    <li>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. 
                    </li>
                    <li>
						Cras vel tincidunt mi, quis vulputate quam. Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam.
                    </li>
                    <li>
						Aenean bibendum eleifend diam imperdiet condimentum. Sed quis leo ut metus scelerisque consequat. Nullam congue nulla sed lectus congue, id ultrices nisi luctus. Nullam sed dapibus massa.
                    </li>
                </ol>
            </div>

            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 style="font-size: 15px;" class="line">Grade Level Definitions</h3>
                <p>School grade levels were defined using the National Center for Education Statistics (NCES) definition: elementary schools are those in which the lowest grade offered is PK through grade 3 and the highest is PK through grade 8, middle schools are those in which the lowest grade offered is grade 4 through grade 7 and the highest is grade 4 through grade 9, high schools are those in which the lowest grade offered is grade 7 through grade 12 and the highest is grade 12, other schools are those with any other configuration that does not fall within the previous three categories.</p>
            </div>

            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 style="font-size: 15px;" class="line">Map Notes</h3>
                <p>Data might be missing from the map if:</p>
                <ol>
                    <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
                    <li>Sed vel mollis quam, ut faucibus dui.</li>
                    <li>Nullam placerat leo et porta dignissim.</li>
                </ol>
            </div>

        </div>

    </footer>

    <!-- Charts -->

    <script>

        // charts

        d3.tsv("assets/data/data.tsv", function (error, data) {
            if (error) { console.log(error); }
            else {
                data.forEach(function (d) {
					d.chart = d.chart;
					d.subchart = +d.subchart;
					d.level = d.level;
                    d.group = d.group;
					d.overall_n = +d.overall_n;
					d.overall_p = +d.overall_p;
                    d.male_n = +d.male_n;
                    d.male_p = +d.male_p;
                    d.female_n = +d.female_n;
                    d.female_p = +d.female_p;
					d.diff_ppt = +d.diff_ppt;
                });

				data2_1 = data.filter(function(d) { return d.chart == "2-1"; });
				data2_2 = data.filter(function(d) { return d.chart == "2-2"; });
                data2_3 = data.filter(function(d) { return d.chart == "2-3"; });
				data3_1 = data.filter(function(d) { return d.chart == "3-1"; });
				data3_2 = data.filter(function(d) { return d.chart == "3-2"; });

				var chart2_1 = barChart().marginLeft(150).data(data2_1).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_1").chartID("chart2_1");
				var chart2_2 = columnThree().data(data2_2).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_2").chartID("chart2_2");
                var chart2_3 = dotTwo().marginLeft(150).data(data2_3).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_3").chartID("chart2_3");
				var chart3_1 = groupedBar().data(data3_1).marginLeft(150).animateTime(750).containerID("three_chart").subcontainerID("three_sections").sectionID("ch3_1").chartID("chart3_1");
                var chart3_2 = groupedBarDiv().marginLeft(150).data(data3_2).containerID("three_chart").subcontainerID("three_sections").sectionID("ch3_2").chartID("chart3_2");

				d3.select("#ch2_1").call(chart2_1);
				d3.select("#ch2_2").call(chart2_2);
                d3.select("#ch2_3").call(chart2_3);
				d3.select("#ch3_1").call(chart3_1);
				d3.select("#ch3_2").call(chart3_2);

            };
        });
		
		// counter
		
		var counterValue = 0;
		
		d3.select("#counter > h2")
			.append("text")
				.text(counterValue);
		
		var gs = graphScroll()
			.container(d3.select("#intro_chart"))
			.graph(d3.selectAll("#counter"))
			.sections(d3.selectAll("#intro_sections > div"))
			.on("active", function() {
				if (document.getElementById("counter").className.indexOf("graph-scroll") >= 0) {
				
				d3.select("#counter > h2")
					.selectAll("text")
					.transition()
						.duration(5000)
						.tween("text", function() {
						
							if (counterValue == 0) { 
						
								var	formatNumber = d3.format(",f");	
								var i = d3.interpolate (0, 2600000);
								counterValue = 2600000;	
								
								return function(t) { d3.select(this).text(formatNumber(i(t))); };
							}
							
						});

			}});

    </script>

	<!-- Map -->
	 
	<script>

		// D3 MAP SCALE
		var scaleSVG = d3.select("#legend").append("svg").attr("class","scaleSVG").attr("height", 120);

		var scale = scaleSVG.append("g")
				.attr("class", "scale")
				.attr("class", "key");
				//.attr("transform", "translateX(25px)");

		scaleSVG.append("rect")
				.attr("height", 15)
				.attr("width", 50)
                .attr("class","grayRect")
				.style("fill", "gray")
				.attr("data-metric", "gray")
				.style("stroke", "black")
				.style("stroke-width", 2)
				.style("pointer", "cursor")
				.attr("transform", "translate(100,60)");
		scaleSVG.append("text")
				.text("Missing Data*")
				.style("font-size", 12)
				.attr("transform", "translate(90,90)");

		var formatNumber = d3.format(",d");

		var color = d3.scale.threshold()
				.domain([0, 3, 6, 12])
				.range(["#f2f0f7", "#cbc9e2", "#9e9ac8", "#756bb1", "#54278f"]);
		var xKey = d3.scale.linear()
				.domain([-3, 15])
				.range([0, 250]);

		var xAxis = d3.svg.axis()
				.scale(xKey)
				.orient("bottom")
				.tickSize(25)
				.tickValues(color.domain())
				.tickFormat(function (d) {
					return d >= 0 ? formatNumber(d) : null;
				});
		var key = d3.select(".key");

		scale.selectAll("rect")
				.data(color.range().map(function (d, i) {
					return {
						x0: i ? xKey(color.domain()[i - 1]) : xKey.range()[0],
						x1: i < color.domain().length ? xKey(color.domain()[i]) : xKey.range()[1],
						z: d
					};
				})).enter()
				.append("rect")
				.attr("height", 15)
				.attr("x", function (d) {
					return d.x0;
				})
				.attr("width", function (d) {
					return d.x1 - d.x0;
				})
				.attr("data-metric", function (d) {
					return d.z;
				})
				.style("fill", function (d) {
					return d.z;
				})
				.style("stroke", "black")
				.style("stroke-width", 2)
				.style("margin", 1);

		scale.call(xAxis).append("text")
				.attr("class", "caption")
				.attr("y", -6);

		scaleSVG.selectAll("rect")
				.on("mouseover", function () {
					var item = d3.select(this);
					if (!key.classed("scaleSelect")) {
						var itemColor = item.attr("data-metric");
						svg.selectAll(".district")
								.attr("fill", function (d) {
									if (itemColor == colorByGroup(d.properties["Percent OOS"])) {
										return itemColor;
									} else {
										return "lightgray";
									}
								});

						svg.selectAll(".secondaryDistrict")
								.attr("fill", function (d) {
									if (itemColor == colorByGroup(d.properties["Percent OOS"])) {
										return itemColor;
									} else {
										return "lightgray";
									}
								});
					}
				}).on("mouseout", function () {
			if (!key.classed("scaleSelect")) {
				updateColors();
			}
		}).on("click", function () {
			var item = d3.select(this);
			var itemColor = item.attr("data-metric");
			if (key.classed("scaleSelect") && item.classed("scaleSelect")) {
				key.attr("class", "key");
				item.attr("class", "");
				item.style("stroke", "black");
				updateColors();
			} else if (key.classed("scaleSelect") && !item.classed("scaleSelect")) {
				d3.select("rect.scaleSelect").attr("class", "").style("stroke", "black");
				item.style("stroke", "yellow");
				item.attr("class", "scaleSelect");
				svg.selectAll(".district")
						.attr("fill", function (d) {
							if (itemColor == colorByGroup(d.properties["Percent OOS"])) {
								return itemColor;
							} else {
								return "lightgray";
							}
						});

				svg.selectAll(".secondaryDistrict")
						.attr("fill", function (d) {
							if (itemColor == colorByGroup(d.properties["Percent OOS"])) {
								return itemColor;
							} else {
								return "lightgray";
							}
						});
			} else {
				item.attr("class", "scaleSelect");
				item.style("stroke", "yellow");
				key.attr("class", "key scaleSelect");
				svg.selectAll(".district")
						.attr("fill", function (d) {
							if (itemColor == colorByGroup(d.properties["Percent OOS"])) {
								return itemColor;
							} else {
								return "lightgray";
							}
						});

				svg.selectAll(".secondaryDistrict")
						.attr("fill", function (d) {
							if (itemColor == colorByGroup(d.properties["Percent OOS"])) {
								return itemColor;
							} else {
								return "lightgray";
							}
						});
			}
		});

		//  D3 MAP
		var width = 960;
		var height = 600;
		var center = [width / 2, height / 2];
		var defaultFill = "lightgray";

		var projection = d3.geo.albersUsa();

		var path = d3.geo.path()
				.projection(projection);

		var zoom = d3.behavior.zoom()
				.scaleExtent([1, 32])
				.on("zoom", move);

		var svg = d3.select("#map").append("svg")
				.attr("preserveAspectRatio", "xMinYMin meet")
				.attr("viewBox", "0 0 " + width + " " + height)
				.classed("svg-content-responsive", true)
				.append("g")
				.call(zoom);
		svg.on("wheel.zoom", null);
		svg.on("mousewheel.zoom", null);

		svg.append("svg:image")
				.attr("xlink:href", "images/progress-anim.gif")
				.attr("id", "progress-image")
				.attr("width", 43)
				.attr("height", 11)
				.attr("x", width / 2)
				.attr("y", height / 2)
				.style("opacity", 1);

		var g = svg.append("g");

		var tooltip = d3.select("body").append("div")
				.attr("class", "districtTooltip")
				.style("opacity", 0);

		queue()
				.defer(d3.json, "assets/data/us.json")
				.defer(d3.json, "assets/data/elementary_unified.json")
				.defer(d3.json, "assets/data/secondary.json")
				.await(ready);

        function ready(error, us, primary, secondary) {
            if (error) {
                console.log(error);
            }
            g.append("g")
                    .selectAll("path")
                    .data(topojson.feature(primary, primary.objects.medium_G5420_G5400).features)
                    .enter().append("path")
                    .attr("id","elementaryDistrict")
                    .attr("class", "district")
                    .attr("d", path)
                    .attr("stroke", "#fff")
                    .attr("stroke-opacity", .15)
                    .attr("stroke-linejoin", "round")
                    .on("mouseover", function (d) {
                        d3.select(this).attr("stroke", "#1A1C20")
                                .attr("stroke-opacity", 1);
                        d3.select(this).classed("selected", true);

                        tooltip.transition().duration(100)
                                .style("opacity", 1)
                                .style("top", (d3.event.pageY - 100) + "px");

                        var windowWidth = $(window).width();
                        if (windowWidth > 1024) {
                            if (d3.event.pageX > 1000) {
                                tooltip.style("left", (d3.event.pageX - 200) + "px");
                            } else {
                                tooltip.style("left", (d3.event.pageX + 40) + "px");
                            }
                        }
                        if (windowWidth < 1024) {
                            if (d3.event.pageX > 400) {
                                tooltip.style("left", (d3.event.pageX - 200) + "px");
                            } else {
                                tooltip.style("left", (d3.event.pageX + 40) + "px");
                            }
                        }
                        if (d.properties["Percent OOS"] != null || d.properties["Total OOS"] != null) {
                            tooltip.html("<h3>" + d.properties.State + "</h3><hr>" +
                                    "<h3>" + d.properties.Name + "</h3>" +
                                    "<div>Total OOS: " + d.properties['Total OOS'] + "</div>" +
                                    "<div>Percent OOS: " + d.properties['Percent OOS'] + "</div>");
                        }else if(d.properties.Name === "School District Not Defined"){
                            tooltip.html("<h3>" + d.properties.State + "</h3><hr>" +
                                    "<h3>No Operating District</h3>");

                        } else {
                            tooltip.html("<h3>" + d.properties.State + "</h3><hr>" +
                                    "<h3>" + d.properties.Name + "</h3>" +
                                    "<div>Total OOS: NO DATA</div>" +
                                    "<div>Percent OOS: NO DATA </div>");
                        }
                    })
                    .on("mouseout", function () {
                        d3.select(this).attr("stroke", "#fff")
                                .attr("stroke-opacity", .15);
                        d3.select(this).classed("selected", false);
                        tooltip.transition().duration(300).style("opacity", 0);
                    });

            g.append("g")
                    .attr("class", "states")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.states).features)
                    .enter().append("path")
                    .attr("class", "state")
                    .attr("d", path);

            d3.select("#selectElementary").on("click", function () {
                d3.select("rect.scaleSelect").attr("class", "").style("stroke", "black");
                key.attr("class", "key");
                d3.select("#selectSecondary").style("background", "white");
                d3.select(this).style("background", "yellow");
                d3.selectAll("#secondaryDistrict").remove();
            });

            d3.select("#selectSecondary").on("click", function () {
                d3.select("rect.scaleSelect").attr("class", "").style("stroke", "black");
                key.attr("class", "key");
                d3.selectAll(".state").remove();
                d3.select("#selectElementary").style("background", "white");
                d3.select(this).style("background", "yellow");
                g.append("g")
                        .selectAll("path")
                        .data(topojson.feature(secondary, secondary.objects.medium_G5410).features)
                        .enter().append("path")
                        .attr("id","secondaryDistrict")
                        .attr("class", "district")
                        .attr("d", path)
                        .attr("stroke", "#fff")
                        .attr("stroke-opacity", .15)
                        .attr("stroke-linejoin", "round")
                        .on("mouseover", function (d) {
                            d3.select(this).attr("stroke", "#1A1C20")
                                    .attr("stroke-opacity", 1);
                            d3.select(this).classed("selected", true);

                            tooltip.transition().duration(100)
                                    .style("opacity", 1)
                                    .style("top", (d3.event.pageY - 100) + "px");


                            var windowWidth = $(window).width();
                            if (windowWidth > 1024) {
                                if (d3.event.pageX > 1000) {
                                    tooltip.style("left", (d3.event.pageX - 200) + "px");
                                } else {
                                    tooltip.style("left", (d3.event.pageX + 40) + "px");
                                }
                            }
                            if (windowWidth < 1024) {
                                if (d3.event.pageX > 400) {
                                    tooltip.style("left", (d3.event.pageX - 200) + "px");
                                } else {
                                    tooltip.style("left", (d3.event.pageX + 40) + "px");
                                }
                            }
                            if (d.properties["Percent OOS"] != null || d.properties["Total OOS"] != null) {
                                tooltip.html("<h3>" + d.properties.State + "</h3><hr>" +
                                        "<h3>" + d.properties.Name + "</h3>" +
                                        "<div>Total OOS: " + d.properties['Total OOS'] + "</div>" +
                                        "<div>Percent OOS: " + d.properties['Percent OOS'] + "</div>");
                            }else if(d.properties.Name === "School District Not Defined"){
                                tooltip.html("<h3>" + d.properties.State + "</h3><hr>" +
                                        "<h3>No Operating District</h3>");

                            } else {
                                tooltip.html("<h3>" + d.properties.State + "</h3><hr>" +
                                        "<h3>" + d.properties.Name + "</h3>" +
                                        "<div>Total OOS: NO DATA</div>" +
                                        "<div>Percent OOS: NO DATA </div>");
                            }
                        })
                        .on("mouseout", function () {
                            d3.select(this).attr("stroke", "#fff")
                                    .attr("stroke-opacity", .15);
                            d3.select(this).classed("selected", false);
                            tooltip.transition().duration(300).style("opacity", 0);
                        });
                updateColors();
                g.append("g")
                        .attr("class", "states")
                        .selectAll("path")
                        .data(topojson.feature(us, us.objects.states).features)
                        .enter().append("path")
                        .attr("class", "state")
                        .attr("d", path);
            });

			// Zoom buttons
			svg.selectAll(".button")
					.data(['zoom_in', 'zoom_out'])
					.enter()
					.append("g")
					.attr("id", function (d) {
						return d
					})
					.attr("class", "button")
					.attr({x: 20, width: 20, height: 20})
					.append("rect")
					.attr("y", function (d, i) {
						return 20 + 25 * i
					})
					.attr({x: 20, width: 20, height: 20});

			// Plus button
			svg.select("#zoom_in")
					.append("line")
					.attr({x1: 25, y1: 30, x2: 35, y2: 30})
					.attr("stroke", "#fff")
					.attr("stroke-width", "2px");
			svg.select("#zoom_in")
					.append("line")
					.attr({x1: 30, y1: 25, x2: 30, y2: 35})
					.attr("stroke", "#fff")
					.attr("stroke-width", "2px");

			// Minus button
			svg.select("#zoom_out")
					.append("line")
					.attr({x1: 25, y1: 55, x2: 35, y2: 55})
					.attr("stroke", "#fff")
					.attr("stroke-width", "2px");

			svg.selectAll(".button")
					.on("click", function () {
						d3.event.preventDefault();

                        var scale = zoom.scale();
                        var extent = zoom.scaleExtent();
                        var translate = zoom.translate();
                        var x = translate[0], y = translate[1];
                        var factor = (this.id === 'zoom_in') ? 2 : 1 / 2;
                        var target_scale = scale * factor;
						var clamped_target_scale = Math.max(extent[0], Math.min(extent[1], target_scale));
						if (clamped_target_scale != target_scale) {
							target_scale = clamped_target_scale;
							factor = target_scale / scale;
						}

						// Center each vector, stretch, then put back
						x = (x - center[0]) * factor + center[0];
						y = (y - center[1]) * factor + center[1];

						// Transition to the new view over 200ms
						d3.transition().duration(200).tween("zoom", function () {
							var interpolate_scale = d3.interpolate(scale, target_scale),
									interpolate_trans = d3.interpolate(translate, [x, y]);
							return function (t) {
								zoom.scale(interpolate_scale(t))
										.translate(interpolate_trans(t));
								svg.call(zoom.event);
							};
						});
					});
			updateColors();
			svg.select("#progress-image").style("opacity", 0);
		}

		function updateColors() {
			svg.selectAll(".district")
					.attr("fill", function (d) {
						return colorByGroup(d.properties["Percent OOS"]);
					});
			svg.selectAll(".secondaryDistrict")
					.attr("fill", function (d) {
						return colorByGroup(d.properties["Percent OOS"]);
					});
		}

		function colorByGroup(p) {

			var d = isNaN(parseFloat(p)) ? -1 : parseFloat(p);
			return d == 0 ? '#f2f0f7' :
					(d > 0 && d <= 3) ? '#cbc9e2' :
							(d > 3 && d <= 6) ? '#9e9ac8' :
									(d > 6 && d <= 12) ? '#756bb1' :
											(d > 12) ? '#54278f' :
													(d < 0) ? 'gray' :
															defaultFill;
		}

		function zoomIn() {
			zoom.scale(zoom.scale() * 2);
			move();
		}

		function move() {
			var t = d3.event.translate,
					s = d3.event.scale;
			t[0] = Math.min(width * (s - 1), Math.max(width * (1 - s), t[0]));
			t[1] = Math.min(height * (s - 1), Math.max(height * (1 - s), t[1]));
			zoom.translate(t);
			g.style("stroke-width", 1 / s).attr("transform", "translate(" + t + ")scale(" + s + ")");
		}

		function clicked(d) {
			var x, y, k;
			var centered;
			if (d && centered !== d) {
				var centroid = path.centroid(d);
				x = centroid[0];
				y = centroid[1];
				k = 4;
				centered = d;
			} else {
				x = width / 2;
				y = height / 2;
				k = 1;
				centered = null;
			}

			g.selectAll("path")
					.classed("active", centered && function (d) {
								return d === centered;
							});

			g.transition()
					.duration(750)
					.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
					.style("stroke-width", 1.5 / k + "px");
		}

		function removeFromArray(arr) {
			var what, a = arguments, L = a.length, ax;
			while (L > 1 && arr.length) {
				what = a[--L];
				while ((ax = arr.indexOf(what)) !== -1) {
					arr.splice(ax, 1);
				}
			}
			return arr;
		}
		d3.select(self.frameElement).style("height", height + "px");
		
	</script>	 	 

</body>
</html>
