<!DOCTYPE html>
<!--
    Hyperspace by Pixelarity
    pixelarity.com @pixelarity
    License: pixelarity.com/license
-->
<html lang="en-us">
<head>
    <title>Access to Reading Materials</title>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="assets/css/main.css" />
	    <!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
    <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->

    <!--<link rel="stylesheet" href="widgets.css" />-->
    <!-- <link rel="stylesheet" href="assets/css/chart-styles.css" /> -->

    <!-- browser tab icon (aka favicon) -->
    <link rel="icon" href="images/doelogo_rev.png" />

    <!-- Scripts -->
    <!--<script src="widgets.js"></script>-->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/skel.min.js"></script>
    <script src="assets/js/util.js"></script>
    <!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
    <script src="assets/js/main.js"></script>

    <!-- Substitutes high-res images for Retina displays (html file only) -->
    <script type="text/javascript" src="assets/js/retina.js"></script>

    <script src="assets/js/d3.v3.min.js"></script>
    <script src="assets/js/d3-tip.js"></script>
    <script src="assets/js/chart-functions.js"></script>
    <script src="assets/js/graph-scroll.js"></script>
	<script src="assets/js/queue.v1.min.js"></script>
    <script src="assets/js/topojson.v1.min.js"></script>

</head>
<body>

    <div id="loader-wrapper">
        <div id="loader"></div>
        <div class="loader-section"></div>
    </div>

    <!-- Sidebar -->
    <section id="sidebar">
        <div class="inner">

            <div class="nav-image">
                <img src="images/edsealbw.svg" alt="U.S. Department of Education" />
            </div>

            <div class="nav-wrapper">
                <nav>
                    <ul style="margin-bottom: 1.5em;">
                        <li><a href="#intro">Introduction</a></li>
                        <!--<li><a href="#one">Big Picture</a></li>-->
                        <li><a href="#two">Book Access Mapped</a></li>
                        <!--<li><a href="#three">The Preschool Crisis</a></li>-->
                        <li><a href="#four">Charge to the Field</a></li>
                    </ul>
                </nav>
                <ul class="icons socialmedia" style="margin-bottom: 0;">
                    <li><a href="#" target="_blank" title="Tweet" class="fa-twitter"><span class="label">Twitter</span></a></li>
                    <li><a href="#" target="_blank" title="Share on Facebook" class="fa-facebook"><span class="label">Facebook</span></a></li>
					<li><a href="#" target="_blank" title="Share on LinkedIn" class="fa-linkedin"><span class="label">LinkedIn</span></a></li>
                    <li><a href="#" target="_blank" title="Email" class="fa-envelope"><span class="label">Email</span></a></li>
                </ul>
            </div>

            <!-- Given Flex, this allows the social media icons to be paired with the navigation links without hugging the bottom -->
            <div>
                &nbsp;
            </div>
        </div>
    </section>

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Intro 1 -->
        <section id="intro" class="wrapper style1 fullscreen fade-up">
            <div class="inner">
                <h1 style="max-width: 650px;">ACCESS TO READING MATERIALS<br></h1>
                <p style="font-size:15pt">Circulation of children’s library materials, by school district.</p>
                <ul class="actions">
                    <li><span class="buttonInactive">— U.S. Department of Education</span></li>
                </ul>
            </div>
        </section>

        <!-- InformED Shouout -->

        <!--<section class="wrapper style5">
            <div class="inner align-center" style="padding-top: 40px; padding-bottom: 20px;">
                <div>
                    <i class="fa fa-bolt fa-lg" style="margin-bottom: 1em; color: rgba(255,255,255,1);"></i>
                </div>
                <p>Powered by InformED and the <a href="http://www2.ed.gov/about/offices/list/ocr/docs/crdc-2013-14.html" target="_blank">2013-14 Civil Rights Data Collection.</a></p>
            </div>
        </section>-->

        <!-- Intro 2 -->
        <section class="wrapper style3">
            <div class="inner">

                <div class="align-right">
                    <div style="margin-bottom: 2.5em;">
                        <input type="checkbox" id="highContrast" name="highContrast">
                        <label for="highContrast">Enable High Contrast (508)</label>
                    </div>
                </div>

                <h2 class="line">Introduction</h2>
                <p class="afterHeader">
					The U.S. Department of Education (Department) recognizes the importance of ensuring every child in the country has access to reading materials in their homes and communities.  In an effort to (1) promote increased efforts to address opportunity gaps and (2) highlight opportunities to improve coordination between schools, libraries and other public sector organizations to improve access,  we analyzed library circulation data to determine where families lack access to free reading materials within their school district.  
                </p>
                <p>
                    In this data story, the Department of Education maps book access across school districts, to identify the natural opportunities between schools, libraries, and other public sector organizations for connecting available reading resources to vulnerable communities. With this analysis, the Department works to promote stronger linkages between resources and families and stronger partnerships between allies in the movement to strengthen children’s reading.
                </p>
				<h2 class="line">My Brother’s Keeper Milestone 2: Reading at grade level by 3<sup>rd</sup> grade</h2>
                <p class="afterHeader">
                   Data from the <a href="http://nces.ed.gov/nationsreportcard/">National Assessment of Educational Progress</a> (NAEP) shows us that students who report having more books in their homes also perform better academically. For example, less than 15% of students with between 0 and 10 books scored proficient in 2015, compared with 50% of students with more than 100 books. 
                </p>
				<h2 class="line">Disparities in Literacy</h2>
                <p class="afterHeader">
                   Sed tincidunt enim sit amet risus vestibulum, sit amet vulputate justo facilisis. Nullam vulputate lectus nec consectetur aliquet. Duis elementum ex mi, vitae congue sapien dignissim a. Morbi fringilla elementum tellus, non porttitor mi pulvinar in. Nulla mattis consectetur lacus, ut ultricies justo tincidunt vel. Nam in ex erat. Vestibulum gravida lobortis condimentum. Fusce dui diam, mollis et orci non, laoreet feugiat mi. Curabitur venenatis turpis vel consequat egestas. Aliquam vel fringilla ligula. Curabitur id tempus dui. Donec condimentum volutpat aliquet. Vivamus rhoncus ut felis ac semper. Sed commodo non enim molestie faucibus. Nunc varius faucibus augue et commodo.
                </p>
                <div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="left icon fa-bar-chart-o"></span></div>
                        </div>
                        <div class="right">
                            Note: Data included in this story may differ slightly from other published reports due to certain data decisions.
                            <a href="#datanotes">More information</a>.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- One -->
        <!--<section id="one" class="wrapper style1">
            <div class="inner">
                <h2 class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit</h2>
                <p>
					Sed tincidunt enim sit amet risus vestibulum, sit amet vulputate justo facilisis. Nullam vulputate lectus nec consectetur aliquet. Duis elementum ex mi, vitae congue sapien dignissim a. Morbi fringilla elementum tellus, non porttitor mi pulvinar in. Nulla mattis consectetur lacus, ut ultricies justo tincidunt vel. Nam in ex erat. Vestibulum gravida lobortis condimentum. Fusce dui diam, mollis et orci non, laoreet feugiat mi. Curabitur venenatis turpis vel consequat egestas. Aliquam vel fringilla ligula. Curabitur id tempus dui. Donec condimentum volutpat aliquet. Vivamus rhoncus ut felis ac semper. Sed commodo non enim molestie faucibus. Nunc varius faucibus augue et commodo.
                </p>
            </div>
        </section>-->

        <!-- Compelling statistics goes here -->
		
        <section id="intro_chart" class="wrapper image1">
			<div id = "intro_sections" class="inner <!--align-center-->">
				<p>
					<h2>
						<ul>
							<li>2.5 million children across the country are enrolled in districts where there are no libraries.</li>
							<li>13 million children are enrolled in districts where the children’s materials circulation is less than 10 per student, including 3.4 million students in poverty and 6.6 million students of color.</li>
						</ul>
					</h2>
				</p>
			</div>
        </section>

        <!-- Two -->
        <section id="two" class="wrapper style1">
            <div class="inner">
                <h2 class="line">Book Access Mapped</h2>
                <p>
					Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam.
                </p>
				<div class="disclaimer">
                    <div style="display: table-row; width: 100%;">
                        <div style="display: table-cell; vertical-align: middle; width: 10%;">
                            <div class="icon"><span class="legendPointer icon fa-mouse-pointer" style="color: #42A667"></span></div>
                        </div>
                        <div class="legendExplain" style="background: #42A667">
                            Hover over school districts for information, double-click to zoom in, and select a range from the legend to see specific views of the data.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Suspension Map -->
        <section class="wrapper chart">
            <div class="inner">

                <div>
                    <div class="align-center">
                        <div id="mapWrapper">

                            <div id="legend">
                                <h3>Annual Circulation of Children’s Library Materials per Student</h3>
                                <div class="legendButtonWrapper">
                                    <div data-value="#54278f" class="legendButton">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">0</div>
                                    </div><div data-value="#756bb1" class="legendButton">
                                    <hr class="verticalLine" size="25">
                                    <div class="legendText"> 1-10 </div>
                                </div><div data-value="#9e9ac8" class="legendButton">
                                    <hr class="verticalLine" size="25">
                                    <div class="legendText">10-25</div>
                                </div><div data-value="#bcbddc" class="legendButton">
                                    <hr class="verticalLine" size="25">
                                    <div class="legendText">25-100</div>
                                </div><div data-value="#dadaeb" class="legendButton">
                                    <hr class="verticalLine" size="25">
                                    <div class="legendText"> More than 100 </div>
                                </div>
                                </div>
                                <div class="innerLegend">
                                    <div data-value="gray" class="legendButton missing">
                                        <hr class="verticalLine" size="25">
                                        <div class="legendText">MISSING*</div>
                                    </div>
                                </div>
                            </div>

                            <div id="map">
                                <div><button class="zoomButton" data-zoom="+1">+</button>
                                    <div style="clear: both; height:5px"></div>
                                    <button class="zoomButton" data-zoom="-1">-</button>
                                </div>
                            </div>
                            <div id="selectDistrictType">
                                <div id="selectElementary" class="selected ">Elementary and Unified</div>
                                <div id="selectSecondary" class="selected ">Independent Elementary, Secondary, and Unified
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <br/>
                    <p class="dataLinksText">* <a href="#datanotes">See data notes</a>. <!--<a href="#">-->Download the district level data<!--</a>--> used in this map.</p>
                </div>
            </div>
        </section>

        <!-- Three -->
        <!--<section id="three" class="wrapper style1">
            <div class="inner">

                <h2 class="line">Suspending over 6,000 of our youngest students</h2>
                <p>
                    Preschool is a critical and important time and sets the foundation for our life-long learning. Shutting out and suspending 3-, 4-, and 5-year-olds from preschool disrupts their time for learning and development. This is why the U.S. Department of Education, in conjunction with the U.S. Department of Health and Human Services, has called on schools and programs to do all they can to <a href="http://www2.ed.gov/policy/gen/guid/school-discipline/policy-statement-ece-expulsions-suspensions.pdf" target="_blank">prevent or severely limit out-of-school suspensions</a> for our youngest learners. There is urgency to this work; school district preschool programs suspended over 6,000 preschool students in 2013–14. Even at this early age, black students are disproportionately affected by out-of-school suspension.
                </p>
            </div>
        </section>

        <section id="three_chart" class="wrapper chart">
            <div id="three_sections" class="inner">
                <div class="align-center">
                    <img class="barChart-icon" src="images/barIcon_chartArea.svg" alt="Bar Chart Icon" />
                </div>
                <div style="margin-bottom: 1.5em" class="chart"></div>
                <div></div>
				<p class = "align-center">View Chart By:</p>
                <div id="ch3_1">
                </div>
                <p style="margin-top: 1.5em;">
					Nearly half of all suspended preschoolers were black and 1 in 5 was Hispanic. Additionally, though white students make up 42 percent of the preschool population, they were 28 percent of those suspended. The data show that suspended preschoolers were overwhelmingly male. The data also show that children with disabilities and English learners were less likely to be suspended as it relates to their enrollment.
                </p>
                <p style="margin-bottom: 3.5em;">
                    Digging deeper into these data shows that there are differences by gender within each race and ethnicity as well. The graph below shows whether each group is overrepresented or underrepresented when suspensions are compared to enrollments.
                </p>
                <div id="ch3_2">
                </div>
				<p style="margin-top:1.5em;">
					Black males had the highest rate of overrepresentation. Black male preschoolers make up less than 10 percent of the population but more than 34 percent of suspended preschoolers, indicating that they are overrepresented in suspensions by nearly 25 percentage points. Black females make up 9 percent of the preschool population but 12 percent of suspended students, indicating that they are overrepresented in the suspension population by 3 percentage points.
        </p>

				<p>
                    This disproportionate impact is one of the many reasons this Administration—through the President’s <a href="https://www.whitehouse.gov/my-brothers-keeper" target="_blank">My Brother’s Keeper</a> initiative as well as the Department’s <a href="http://www2.ed.gov/policy/gen/guid/school-discipline/index.html" target="_blank">#RethinkDiscipline</a> campaign and the Department’s partnership with the White House Council on Women and Girls—has made reforming school discipline one of its top priorities. For example, the Department of Education is working with the <a href="https://www.law.georgetown.edu/academics/centers-institutes/poverty-inequality/" target="_blank">Georgetown Center on Law and Poverty</a> and the <a href="https://www.whitehouse.gov/administration/eop/cwg" target="_blank">White House Council on Women and Girls</a> to host a conference in fall 2016 on improving school systems’ responses to trauma in girls of color.
                </p>
                <div></div>
            </div>
        </section> -->

        <section id="four" class="wrapper style3">
            <div class="inner">
                <h2 class="line">Charge to the Field</h2>
                <p>
					We urge the field to consider new opportunities for translating access into impact. Take a look at your school district and consider how you can support the libraries within it in delivering on their mission or whether the flow of children’s materials is reaching the families who need resources the most. <strong>Here’s what we’re doing…</strong>
                </p>

			<div class="socialmedia">
				<ul class="align-center icons fa-2x" style="margin-bottom:1em;">
					<li><a href="#" target="_blank" title="Tweet" class="fa-twitter"><span class="label">Twitter</span></a></li>
					<li><a href="#" target="_blank" title="Share on Facebook" class="fa-facebook"><span class="label">Facebook</span></a></li>
					<li><a href="#" target="_blank" title="Share on LinkedIn" class="fa-linkedin"><span class="label">LinkedIn</span></a></li>
					<li><a href="#" target="_blank" title="Email" class="fa-envelope"><span class="label">Email</span></a></li>
				</ul>
			</div>

            </div>
        </section>

        <!--<section class="wrapper style1">
            <div class="inner">



                <h2 class="line">Lorem ipsum dolor sit amet</h2>
                <p>
                    Sed vel mollis quam, ut faucibus dui. Nullam placerat leo et porta dignissim. Aliquam id ultrices nibh. Phasellus non ligula eros. Pellentesque non sapien justo. Cras vel tincidunt mi, quis vulputate quam.
                </p>

                <p>
                    Duis consectetur, enim quis mollis egestas, justo dui ultricies elit, id viverra lorem erat sed diam. Vestibulum ut metus et mauris pharetra commodo nec venenatis nisi. In eget lobortis ligula, fermentum ultricies arcu. Etiam elit leo, sollicitudin sit amet rhoncus a, commodo fermentum lectus.
                </p>

                <p style="margin-bottom: 3.5em;">
                    Proin pharetra hendrerit nulla nec pulvinar. In bibendum laoreet orci a venenatis. Vivamus ac laoreet libero. Vestibulum blandit semper elementum:
                </p>

                <ul class="callout">
                    <li>
                        <h3 class="icon style1 fa-bus"><a href="#">Sed ultricies pulvinar rhoncus. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae.</a></h3>
                        <p>Cras malesuada, felis a congue rhoncus, felis ipsum venenatis justo, non viverra est sapien eu nisl. Suspendisse scelerisque non nibh et euismod. In condimentum diam vitae tellus vestibulum, ut rhoncus lectus finibus. </p>
                    </li>
                    <li>
                        <h3 class="icon style2 fa-trophy"><a href="#">Vivamus pulvinar pharetra sem vitae dapibus.</a></h3>
                        <p>Mauris convallis volutpat nisi, vel porta felis fringilla quis. Curabitur vel tellus a elit fermentum lacinia. Proin a neque eget felis ornare finibus. Nunc sed ultrices libero. Integer sed dictum est. Nam felis metus, commodo et cursus at, volutpat ut ex. Aenean bibendum eleifend diam imperdiet condimentum. </p>
                    </li>
                    <li>
                        <h3 class="icon style3 fa-table"><a href="#">Maecenas facilisis tincidunt fermentum. Nunc vestibulum elementum purus cursus lobortis.</a></h3>
                        <p>Curabitur consequat, felis hendrerit dapibus rhoncus, arcu enim blandit dui, viverra porta tellus lectus quis neque. Fusce vulputate nec est vel viverra. Suspendisse nec mauris pellentesque, ultricies eros sed, auctor ligula. Vivamus tincidunt neque vel euismod euismod. Aenean iaculis urna ac ipsum accumsan posuere. Duis sagittis in justo sed viverra. </p>
                    </li>
                </ul>

            </div>
        </section>-->

    </div>

    <!-- Footer -->
    <footer id="footer" class="wrapper style1-alt">
        <div class="inner align-center">
			<h2 id="datanotes" style="font-size:15px; font-weight:bold; margin-top:3.5em;">ENDNOTES</h2>
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 class="line">Data Processing Notes</h3>
                <p>
					A district’s annual circulation of children’s library materials is based on public use data files from Institute of Museum and Library Services (IMLS) FY 2014 Public Libraries Survey (PLS). These data were assigned to districts in three steps.
				</p>
                <ol>
                    <li>
                        Based on assigned latitude and longitude from the PLS data and the district boundaries from the 2013 TIGER/Line Shapefiles, each library outlet was assigned to a district. (In situations where an outlet was located within the boundaries of more than one district, the outlet was assigned to each of those overlapping districts.)
                    </li>
                    <li>
						Districts were assigned data from the PLS administrative entity file for the library system with at least one outlet within the district’s boundaries. For districts with outlets from more than one library system, the district’s annual circulation of children’s materials represents the sum of the annual circulation for each of the library systems with outlets within the district’s boundaries. If the library system’s annual circulation data were missing, the district’s annual circulation of children’s materials also was missing.
                    </li>
					<li>
						Districts with no library outlets within their boundaries were assigned zero as their annual circulation of children’s materials.
					</li>
                </ol>
				<p>
					A district’s per student annual circulation of children’s library material was calculated by dividing the annual circulation by the number of students in the district. The number of students in the district  came from the 2013-14 National Center for Education Statistics’ Common Core of Data (CCD) Local Education Agency (School District) Universe Survey. Districts with missing data for either the number of students or annual circulation were assigned a missing value for the per student circulation. (Districts with zero students also were assigned a missing value for the per student annual circulation.)
				</p>
				<p>
					The child poverty rate came from the 2014 Small Area Income and Poverty Estimates (SAIPE) school district data supplemented with SAIPE county data for the 5 boroughs (counties) of New York City (NYC). For the 32 mapped school districts in NYC, districts were assigned the poverty data for the county where they are located.
				</p>
				<p>
					Student percent minority was based on LEA data from the CCD. For the purpose of this story map, minority was defined as students in the district who are American Indian/Alaska Native, Asian, Black, Native Hawaiian/Pacific Islander, Hispanic, or Two or More Races. Districts with missing or zero students were assigned a missing value for student percent minority.
				</p>
            </div>
            <div class="6u$ 12u$(medium) dataExclusion">
                <h3 style="font-size: 15px;" class="line">Map-Specific Notes</h3>
                <p>
					On this map, the label <strong>Elementary</strong> includes all school districts that are financially responsible for providing education only to children in the elementary grades. Some elementary districts share territory with one or more Secondary districts. The label Independent Elementary refers to those Elementary school districts that are geographically independent of other school districts.
				</p>
				<p>
					The label <strong>Secondary</strong> includes all school districts that are financially responsible for providing education only to children in the upper grades. This includes pseudo-secondary school districts created by the Census Bureau. 
				</p>
				<p>
					The label <strong>Unified</strong> refers to districts that provide education to children of all school ages. In general, where there is a unified school district, no elementary or secondary school district exists.
				</p>
				<p>
					Map areas displayed as having missing data include: 
				</p>
                <ul>
                    <li>Districts with missing enrollment data in the 2013-14 National Center for Education Statistics’ Common Core of Data (CCD).</li>
                    <li>Districts whose library outlets belong to a library system with missing children’s materials circulation data from the Public Libraries Survey (PLS).</li>
                    <li>Districts that do not match to the U.S. Census Bureau’s 2013 TIGER/Line Shapefiles (machine readable data files) used to produce the map.</li>
					<li>Spatial areas that do not align with any school district reported in the CCD. For more information refer to the 2013 TIGER/Line Shapefiles technical documentation.</li>
                </ul>
            </div>
		</div>

    </footer>

    <!-- Charts -->

    <!--<script>

        // charts

        d3.tsv("assets/data/data.tsv", function (error, data) {
            if (error) { console.log(error); }
            else {
                data.forEach(function (d) {
					d.chart = d.chart;
					d.subchart = +d.subchart;
					d.level = d.level;
                    d.group = d.group;
					d.overall_n = +d.overall_n;
					d.overall_p = +d.overall_p;
                    d.male_n = +d.male_n;
                    d.male_p = +d.male_p;
                    d.female_n = +d.female_n;
                    d.female_p = +d.female_p;
					d.enrolled_p = +d.enrolled_p;
					d.suspended_p = +d.suspended_p;
					d.diff_ppt = +d.diff_ppt;
					d.enrolled_n = +d.enrolled_n;
					d.suspended_n = +d.suspended_n;
                });

				data1_2 = data.filter(function(d) { return d.chart == "1-2"; });
				data2_1 = data.filter(function(d) { return d.chart == "2-1"; });
				data2_2 = data.filter(function(d) { return d.chart == "2-2"; });
                data2_3 = data.filter(function(d) { return d.chart == "2-3"; });
				data3_1 = data.filter(function(d) { return d.chart == "3-1"; });
				data3_2 = data.filter(function(d) { return d.chart == "3-2"; });

				var counterChart = counter().data(data1_2).containerID("intro_chart").subcontainerID("intro_sections").sectionID("counter").chartID("counter");
				var chart2_1 = barChart().marginLeft(150).data(data2_1).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_1").chartID("chart2_1")
					.title("Black students are the most likely to receive an out-of-school suspension.")
					.altText("This chart displays the percentage of students receiving one or more out-of school suspensions, overall and within each racial or ethnic category, in 2013-14.");
				var chart2_2 = columnThree().data(data2_2).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_2").chartID("chart2_2")
					.title1("Male students are more than twice as likely to be suspended as female students.")
					.title2("1 in 10 students with disabilities received at least one out-of-school suspension.")
					.title3("English language learners are suspended at a rate below the national average.")
					.altText1("This chart displays the percentage of students receiving one or more out-of school suspensions, overall and by gender, in 2013-14.")
					.altText2("This chart displays the percentage of students receiving one or more out-of school suspensions, overall and by disability status, in 2013-14.")
					.altText3("This chart displays the percentage of students receiving one or more out-of school suspensions, overall and by English Language Learner status, in 2013-14.");
                var chart2_3 = dotTwo().marginLeft(150).data(data2_3).containerID("two_chart").subcontainerID("two_sections").sectionID("ch2_3").chartID("chart2_3")
					.title("Males are more likely to be suspended in every racial and ethnic group.")
					.altText("This chart displays the percentage of females and males receiving one or more out-of-school suspensions, overall and by racial or ethnic category, in 2013-14.");
				var chart3_1 = groupedBar().data(data3_1).marginLeft(150).animateTime(750).containerID("three_chart").subcontainerID("three_sections").sectionID("ch3_1").chartID("chart3_1")
					.title1("Although only 19% of the preschool population is black, they make up 46% of suspended preschoolers.")
					.title2("78% of all suspended preschoolers were male.")
					.title3("20% of all preschoolers were identified as having a disability, but children with disabilities make up 15% of those suspended.")
					.title4("13% of preschoolers were English language learners but 7% of those suspended were.")
					.altText1("This chart displays the percentage of total enrollment and total students receiving one or more out-of-school suspensions, by racial or ethnic category, in 2013-14.")
					.altText2("This chart displays the percentage of total enrollment and total students receiving one or more out-of-school suspensions, by gender, in 2013-14.")
					.altText3("This chart displays the percentage of total enrollment and total students receiving one or more out-of-school suspensions, by disability status, in 2013-14.")
					.altText4("This chart displays the percentage of total enrollment and total students receiving one or more out-of-school suspensions, by English Language Learner status, in 2013-14.");
                var chart3_2 = groupedBarDiv().marginLeft(150).data(data3_2).containerID("three_chart").subcontainerID("three_sections").sectionID("ch3_2").chartID("chart3_2")
					.title("Black females are the only group of female students who are disproportionately suspended in preschool.")
					.altText("This chart displays, at the preschool level, the percentage point difference between the percentage of total enrollment and percentage of total students receiving one or more out-of-school suspensions for females and males, by racial or ethnic category, in 2013-14.");

				d3.select("#counter").call(counterChart);
				d3.select("#ch2_1").call(chart2_1);
				d3.select("#ch2_2").call(chart2_2);
                d3.select("#ch2_3").call(chart2_3);
				d3.select("#ch3_1").call(chart3_1);
				d3.select("#ch3_2").call(chart3_2);

            };
        });

    </script>-->

    <!-- Map -->

    <script>
        /*
         "a":"State"
         "b":"Name"
         "c":"Students"
         "d":"Number of public library service outlets"
         "e":"Percent students of circulated children's materials"
         "f":"Circulation rate category"
         "g":"Child poverty rate"
         "h":"Percent minority students"
         */
        $("#legend").css("display", "none");
        //  D3 MAP
        var width = 960;
        var height = 600;
        var center = [width / 2, height / 2];
        var defaultFill = "#E6E6E6";

        var projection = d3.geo.albersUsa()
                .translate([width / 2, height / 2])
                .scale(1000);
        var zoom = d3.behavior.zoom()
                .scaleExtent([1, 32])
                .on("zoom", move);

        var path = d3.geo.path()
                .projection(projection);

        var svg = d3.select("#map").append("svg")
                .attr("preserveAspectRatio", "xMinYMin meet")
                .attr("viewBox", "0 0 " + width + " " + height)
                .classed("svg-content-responsive", true)
                .append("g");

        var g = svg.append("g");

        svg.append("svg:image")
                .attr("xlink:href", "images/progress-anim.gif")
                .attr("id", "progress-image")
                .attr("width", 30)
                .attr("height", 30)
                .attr("x", width / 2)
                .attr("y", height / 2)
                .style("opacity", 1);

        svg.call(zoom).call(zoom.event);

        var tooltip = d3.select("body").append("div")
                .attr("class", "districtTooltip")
                .style("opacity", 0);

        queue()
                .defer(d3.json, "assets/data/states.json")
                .defer(d3.json, "assets/data/elementary.json")
                .defer(d3.json, "assets/data/secondary.json")
                .defer(d3.json, "assets/data/extra.json")
                .await(ready);

        svg.on("wheel.zoom", null);
        svg.on("mousewheel.zoom", null);

        function ready(error, us, primary, secondary, extra) {
            if (error) {
                console.log(error);
            }
            g.attr("cursor","pointer");

            g.append("g")
                    .selectAll("path")
                    .data(topojson.feature(primary, primary.objects.medium_G5420_G5400).features)
                    .enter().append("path")
                    .attr("id", "elementaryDistrict")
                    .attr("class", "district")
                    .attr("d", path)
                    .attr("stroke", "#fff")
                    .attr("stroke-opacity", .15)
                    .attr("stroke-linejoin", "round")
                    .on("mouseover", function (d) {
                        createTooltip(this,d);
                    })
                    .on("mouseout", function () {
                        removeTooltip(this);
                    });

            g.append("g")
                    .selectAll("path")
                    .data(topojson.feature(extra, extra.objects.extra_districts).features)
                    .enter().append("path")
                    .attr("id", "elementaryDistrict")
                    .attr("class", "district")
                    .attr("d", path)
                    .attr("stroke", "#fff")
                    .attr("stroke-opacity", .15)
                    .attr("stroke-linejoin", "round")
                    .on("mouseover", function (d) {
                        createTooltip(this,d);
                    })
                    .on("mouseout", function () {
                        removeTooltip(this);
                    });

            g.append("g")
                    .attr("class", "states")
                    .selectAll("path")
                    .data(topojson.feature(us, us.objects.states).features)
                    .enter().append("path")
                    .attr("class", "state")
                    .attr("d", path);

            d3.select("#selectElementary").on("click", function () {
                d3.select("#selectSecondary").style("background", "white")
                        .style("color","#1A1C20");
                d3.select(this).style("background", "#1A1C20")
                        .style("color","white");
                d3.selectAll("#secondaryDistrict").remove();
            });

            d3.select("#selectSecondary").on("click", function () {
                d3.selectAll(".state").remove();
                d3.select("#selectElementary").style("background", "white")
                        .style("color","#1A1C20");
                d3.select(this).style("background", "#1A1C20")
                        .style("color","white");
                g.append("g")
                        .selectAll("path")
                        .data(topojson.feature(secondary, secondary.objects.medium_G5410).features)
                        .enter().append("path")
                        .attr("id", "secondaryDistrict")
                        .attr("class", "district")
                        .attr("d", path)
                        .attr("stroke", "#fff")
                        .attr("stroke-opacity", .15)
                        .attr("stroke-linejoin", "round")
                        .on("mouseover", function (d) {
                            createTooltip(this,d);
                        })
                        .on("mouseout", function () {
                            removeTooltip(this);
                        });
                updateColors();
                g.append("g")
                        .attr("class", "states")
                        .selectAll("path")
                        .data(topojson.feature(us, us.objects.states).features)
                        .enter().append("path")
                        .attr("class", "state")
                        .attr("d", path);
            });

            updateColors();
            createLegend();
            svg.select("#progress-image").style("opacity", 0);
            $("#legend").css("display", "block");
        }

        function removeTooltip(currentDistrict){
            d3.select(currentDistrict).attr("stroke", "#fff")
                    .attr("stroke-opacity", .15);
            d3.select(currentDistrict).classed("selected", false);
            tooltip.transition().duration(300).style("opacity", 0);
        }

        function createTooltip(currentDistrict,d){
            var format = d3.format("0,000");
            //var decimal = d3.format(",.1f");
            var state = (d.properties.a === null)? "NO DATA": d.properties.a;
            var name = (d.properties.b === null)? "NO DATA": d.properties.b;
            var students = (d.properties.c === null)? "NO DATA": d.properties.c;
            if(!isNaN(students)){
                students = format(students);
            }
            var annualCirculation = (d.properties.d === null)? "NO DATA": d.properties.d;
            if(!isNaN(annualCirculation)){
                annualCirculation = format(annualCirculation);
            }
            //var percentStudentsCirculated = d.properties.e;
            //var circulationRateCategory = d.properties.f;
            var childPovertyRate = (d.properties.g == null)? "NO DATA": d.properties.g;
            var percentMinorityStudents = (d.properties.h == null)? "NO DATA": d.properties.h;
            d3.select(currentDistrict).attr("stroke", "#1A1C20")
                    .attr("stroke-opacity", 1);
            d3.select(currentDistrict).classed("selected", true);

            tooltip.transition().duration(100)
                    .style("opacity", 1)
                    .style("top", (d3.event.pageY - 100) + "px");

            var windowWidth = $(window).width();
            if (windowWidth > 1024) {
                if (d3.event.pageX > 1000) {
                    tooltip.style("left", (d3.event.pageX - 320) + "px");
                } else {
                    tooltip.style("left", (d3.event.pageX + 80) + "px");
                }
            }
            if (windowWidth < 1024 && windowWidth > 850) {
                if (d3.event.pageX > 400) {
                    tooltip.style("left", (d3.event.pageX - 320) + "px");
                } else {
                    tooltip.style("left", (d3.event.pageX + 80) + "px");
                }
            }
            if (windowWidth < 850) {
                if (d3.event.pageX > 350) {
                    tooltip.style("left", (d3.event.pageX - 320) + "px");
                } else {
                    tooltip.style("left", (d3.event.pageX + 40) + "px");
                }
            }
            if (windowWidth < 680) {
                if (d3.event.pageX > 350) {
                    tooltip.style("left", (d3.event.pageX - 320) + "px");
                } else {
                    tooltip.style("left", (d3.event.pageX + 20) + "px");
                }
            }
            if (name === "School District Not Defined") {
                tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                        "<h3>No Operating District</h3>");

            }else if (name != null ) {
                tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                        "<h4>" + name + "</h4><hr>" +
                        "<div> Number of public library service outlets: " + annualCirculation + "</div>" +
                        "<div> Students: " + students + "</div>" +
                        "<div> Child poverty rate: " + childPovertyRate + "</div>" +
                        "<div> Student percent minority: " + percentMinorityStudents + "</div>");
            }else{
                tooltip.html("<h3>" + state.toUpperCase() + "</h3><hr>" +
                        "<h4>" + name + "</h4><hr>" +
                        "<div> NO DATA </div>");
            }
        }

        function createLegend() {
            var legendButton = $(".legendButton");
            legendButton.each(function () {
                var buttonValue = $(this).attr("data-value");
                var totalDistricts = document.getElementsByClassName("district").length;
                var valueSize = document.getElementsByClassName(buttonValue).length;
                var width = (valueSize / totalDistricts) * 100;
                if ($(this).hasClass("missing")) {
                    width = width * 4;
                }
                $(this).css("background-color", buttonValue);
                $(this).css("width", (width) + '%');
            });

            legendButton.on("click", function () {
                if ($(this).hasClass("highlightButton")) {
                    legendButton.each(function () {
                        $(this).css("border", 0);
                        $(this).removeClass("highlightButton");
                    });
                    updateColors();
                } else {
                    legendButton.each(function () {
                        $(this).css("border", 0);
                        $(this).removeClass("highlightButton");
                    });
                    $(this).addClass("highlightButton");
                    var buttonValue = $(this).attr("data-value");
                    svg.selectAll(".district")
                            .attr("fill", function (d) {
                                if (buttonValue == colorByGroup(d.properties.f)) {
                                    return buttonValue;
                                } else {
                                    return "#E6E6E6";
                                }
                            });
                }
            });
        }

        function updateColors() {
            svg.selectAll(".district")
                    .attr("fill", function (d) {
                        d3.select(this).attr("class", "district " + colorByGroup(d.properties.f));
                        return colorByGroup(d.properties.f);
                    });
        }

        function colorByGroup(f) {
            switch (f){
                case "0": return 'gray'; break;
                case "1": return '#dadaeb'; break;
                case "2": return '#bcbddc'; break;
                case "3": return '#9e9ac8'; break;
                case "4": return '#756bb1'; break;
                case "5": return '#54278f'; break;
                default : return 'black'; break;
            }
        }

        function interpolateZoom(translate, scale) {
            var self = this;
            return d3.transition().duration(350).tween("zoom", function () {
                var iTranslate = d3.interpolate(zoom.translate(), translate),
                        iScale = d3.interpolate(zoom.scale(), scale);
                return function (t) {
                    zoom.scale(iScale(t))
                            .translate(iTranslate(t));
                    move();
                };
            });
        }

        function zoomClick() {
            var clicked = d3.event.target,
                    direction = 1,
                    factor = 0.2,
                    target_zoom = 1,
                    center = [width / 2, height / 2],
                    extent = zoom.scaleExtent(),
                    translate = zoom.translate(),
                    translate0 = [],
                    l = [],
                    view = {x: translate[0], y: translate[1], k: zoom.scale()};
            d3.event.preventDefault();
            direction = this.getAttribute("data-zoom");
            target_zoom = zoom.scale() * (1 + factor * direction);

            if (target_zoom < extent[0] || target_zoom > extent[1]) {
                return false;
            }

            translate0 = [(center[0] - view.x) / view.k, (center[1] - view.y) / view.k];
            view.k = target_zoom;
            l = [translate0[0] * view.k + view.x, translate0[1] * view.k + view.y];

            view.x += center[0] - l[0];
            view.y += center[1] - l[1];

            interpolateZoom([view.x, view.y], view.k);
        }

        function move() {
            d3.selectAll(".state").attr("stroke-width", resizeStateBorder());
            g.style("stroke-width", 1 / zoom.scale())
                    .attr("transform", "translate(" + zoom.translate() + ")scale(" + zoom.scale() + ")");
        }

        function resizeStateBorder() {
            var z = zoom.scale();
            return (z > 7) ? .25 :
                    (z > 4) ? .5 :
                            1
        }

        d3.selectAll("button[data-zoom]")
                .on("click", zoomClick);
        d3.select(self.frameElement).style("height", height + "px");

    </script>


</body>
</html>
